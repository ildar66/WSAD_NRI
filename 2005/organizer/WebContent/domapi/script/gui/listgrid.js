/*
Copyright (c) Nebiru Software 2001, 2005
  Compressed and obfuscated by JSCruncher Pro.
  http://domapi.com/jscruncherpro
*/
domapi.loadUnit("dataset");domapi.loadUnit("customdrag");domapi.registerComponent("listgrid");if(domapi.trace)dump("Trace is on.");domapi.Listgrid=function(i2T25){return domapi.comps.listgrid.constructor(i2T25)};domapi.comps.listgrid.constructor=function(i2T25){var x3A00=domapi.Component(i2T25,"listgrid");try{x3A00.data=new domapi.Dataset({G437n:x3A00});x3A00.It93=document.createElement("DIV");x3A00.BD1I=document.createElement("DIV");x3A00._OQFQ=document.createElement("DIV");x3A00.eD$m=document.createElement("DIV");x3A00.EAH4=document.createElement("DIV");x3A00.d15L5=document.createElement("DIV");x3A00.k65={mi7mO:domapi.l3i_1(),Hs00:false,u1Xd:false,JJm$3:false,toprow:0,a4K:0,visiblerows:0,viewablerows:0,visiblecols:[],H$P:0,visiblerowsheight:0,visiblecolswidth:0,qBiu:0,Uxex:0,p64:[],GQip5:[],vertscrollbarvisible:false,horzscrollbarvisible:false,viewportw:i2T25["w"],viewporth:i2T25["h"]};x3A00._OQFQ.a1e="";x3A00._OQFQ.a1e.A47e=0;x3A00.It93.className="DA_LISTGRID_DATA";x3A00.BD1I.className="DA_LISTGRID_HEADER";x3A00._OQFQ.className="DA_LISTGRID_ROWBAR";x3A00.eD$m.className="DA_LISTGRID_UPPERLEFT_SPACE";x3A00.EAH4.className="DA_LISTGRID_GOBO_CONTAINER";x3A00.BD1I.DA_TYPE="LISTGRID_HEADER";x3A00.eD$m.DA_TYPE="LISTGRID_UPPERLEFT_SPACE";x3A00._OQFQ.DA_TYPE="LISTGRID_ROWBAR";x3A00.setGridlines(x3A00.gridlines);x3A00.cols=x3A00.BD1I.childNodes;x3A00.selected=[];x3A00.currentRow=-1;x3A00.currentCol=-1;x3A00.EAH4.appendChild(x3A00.d15L5);x3A00.appendChild(x3A00.BD1I);x3A00.appendChild(x3A00.It93);x3A00.appendChild(x3A00._OQFQ);x3A00.appendChild(x3A00.eD$m);x3A00.appendChild(x3A00.EAH4);x3A00.V59nd=domapi.Elm({parent:x3A00,x:0,y:0,w:50,h:domapi.theme.skin.metrics.headerbar.h});x3A00.V59nd.setAlpha(80);x3A00.V59nd.setZ(1000);x3A00.V59nd.className="DA_LISTGRID_GHOST";x3A00.V59nd.style.display="none";x3A00.V59nd.showing=false;x3A00.Qc4i=domapi.Elm({parent:x3A00,x:0,y:0,w:1,h:100});x3A00.Qc4i.setZ(20);x3A00.Qc4i.style.border="0px dashed black";x3A00.Qc4i.style.borderLeftWidth="1px";x3A00.Qc4i.showing=false;x3A00.Qc4i.hide();var p=domapi.mJ00.listgrid;x3A00.Fo0k7=p.Fo0k7;x3A00.EAH4.onscroll=p.qw33W;domapi.addEvent(x3A00.BD1I,"mouseover",p.kMo);domapi.addEvent(x3A00.BD1I,"mouseout",p.q_2M);domapi.addEvent(x3A00.BD1I,"mousemove",p.$WY);domapi.addEvent(x3A00.BD1I,"mousedown",p.xYq);domapi.addEvent(x3A00.BD1I,"mouseup",p.Ykd);domapi.addEvent(x3A00,"mouseup",p.n245);domapi.addEvent(x3A00,domapi.isIE?"mousewheel":"DOMMouseScroll",p.pR7I3);domapi.Elm({ref:x3A00.BD1I});x3A00.BD1I.doAllowDrag=true;x3A00.BD1I.Vw$$8="none";x3A00.BD1I.turnOnCustomDrag({});x3A00.BD1I.ondragallow=p.ondragallow;x3A00.BD1I.ondragstart=p.ondragstart;x3A00.BD1I.ondragmove=p.ondragmove;x3A00.BD1I.ondragend=p.ondragend;if(domapi.debug){x3A00.dumpState=function(){return domapi.mJ00.listgrid.dumpState(this)};x3A00.w503=function(){return domapi.mJ00.listgrid.w503(this)}}if(x3A00.doAllowDrag)x3A00.turnOnCustomDrag({});domapi.hl1(x3A00);domapi.addEvent(domapi.isIE?x3A00:x3A00.r40s5,"keydown",p.i$144);return x3A00}finally{x3A00=null}};domapi.comps.listgrid.Gk8HS=function(){for(var i=0;i<this.cols.length;i++)this.cols[i].S8e=null;this.V59nd=null;this.data=null;this.It93=null;this.BD1I=null;this._OQFQ=null;this.eD$m=null;this.EAH4=null;this.d15L5=null;$0h(this.k65);this.k65=null;this.Qc4i=null;this.cols=null;this.selected=null};domapi.comps.listgrid.Q43hR=function(){this.lF5A3()};domapi.comps.listgrid.lF5A3=function(){if(domapi.trace)dump(this.toString()+'.listgridDraw()');var t=domapi.theme;var s=this.style;var b=this.doBorder?t.border.width:0;try{this.setB(b);s.borderStyle=this.doBorder?t.border.solid:"none";s.borderColor=t.border.getInset();if(this.doLedgerMode)domapi.css.addClass(this,"DA_LISTGRID_LEDGER");else domapi.css.removeClass(this,"DA_LISTGRID_LEDGER")}finally{t=null;s=null}};domapi.comps.listgrid.MR9=function(w,h){if(domapi.trace)dump(this.toString()+'._layout('+w+', '+h+')');this.s3kp();var C,i,c,s;var Iuy4=h;var _r4mw=w;var P6c=this.k65;var H=this.BD1I;var C=this.EAH4;var R=this._OQFQ;var Qg355=this.It93;var S5_52=this.eD$m;var JAT72=P6c.a4K;var V61$=P6c.H$P;try{H.style.height=V61$-((domapi.isIE&&domapi.isStrict&&V61$>2)||(domapi.isKHTML)?2:0)+"px";R.style.width=JAT72-((domapi.isIE&&domapi.isStrict&&JAT72>2)||(domapi.isKHTML)?2:0)+"px";S5_52.style.width=JAT72+"px";S5_52.style.height=V61$+"px";S5_52.style.display=(this.doShowHeader&&this.doShowRowbar)?"":"none";R.style.display=this.doShowRowbar?"":"none";H.style.display=this.doShowHeader?"":"none";for(i=0;i<Qg355.childNodes.length;i++){C=Qg355.childNodes[i];domapi.disallowSelect(C);if(C.a1e!=""){C.innerHTML+=C.a1e;C.a1e="";C.Y7MFF=0}}if(R.a1e!=""){R.innerHTML+=R.a1e;R.a1e=""}if(!this.h982u){var C=Qg355.childNodes;if(C.length){c=C[C.length-1];s=this.d15L5.style;w=P6c.visiblecolswidth+(domapi.isIE?(domapi.isStrict?1:0):2);P6c.viewportw=_r4mw;s.width=w+"px";Qg355.style.width=w+"px";if(c.childNodes.length){h=P6c.visiblerowsheight+V61$+"px";s.height=h;Qg355.style.height=h;if(this.doVirtualMode)P6c.viewporth=Iuy4;else P6c.viewporth=Iuy4}}this.q046()}if(!this.doAllowNoSelect&&this.currentRow!=-1&&C.length){if(!this.$1d7)this.selectRow(this.currentRow,true,true);this.$1d7=true}else if(!this.doAllowNoSelect&&this.currentRow==-1&&C.length){this.currentRow=0;this.selectRow(0,true,true)}domapi.mJ00.listgrid.Dv3$.apply(this)}finally{P6c=null;H=null;C=null;R=null;Qg355=null;S5_52=null}};domapi.comps.listgrid.q046=function(){if(domapi.trace)dump(this.toString()+'._layoutScroll()');var P6c=this.k65;var c27f2=this.doVirtualMode;var H=this.BD1I;var C=this.EAH4;var R=this._OQFQ;var Qg355=this.It93;var JAT72=P6c.a4K;var V61$=P6c.H$P;try{Qg355.style.left=JAT72-C.scrollLeft+"px";Qg355.style.top=V61$-(c27f2?0:C.scrollTop)+"px";R.style.top=V61$-(c27f2?0:C.scrollTop)+"px";H.style.left=JAT72-C.scrollLeft+"px";H.style.width=this.d15L5.offsetWidth-(domapi.isIE?0:2)+"px";var r=C.scrollLeft+this.offsetWidth-JAT72;var b=(c27f2?0:C.scrollTop)+this.offsetHeight-V61$;if(P6c.vertscrollbarvisible)r-=(P6c.mi7mO+2);if(P6c.horzscrollbarvisible)b-=(P6c.mi7mO+2);H.style.clip="rect(0px, "+r+"px, "+H.offsetHeight+"px, 0px)";Qg355.style.clip="rect("+(c27f2?0:C.scrollTop)+"px, "+r+"px, "+b+"px, "+C.scrollLeft+"px)";P6c.p64=[0,r,H.offsetHeight,0];P6c.GQip5=[(c27f2?0:C.scrollTop),r,b,C.scrollLeft]}finally{P6c=null;c27f2=null;H=null;C=null;R=null;Qg355=null}};domapi.comps.listgrid.clear=function(){if(domapi.trace)dump(this.toString()+'.clear()');this.selectNone();this.currentRow=-1;this.currentCol=-1;this.EAH4.scrollTop=0;this.k65.qBiu=0;this.data.clear();var C=this.cols;try{var c;for(var i=C.length-1;i>=0;i--){if(C[i].S8e){var c=C[i].S8e;if(c.DA_TYPE)c.hide();else c.style.display="none"}}for(i=0;i<C.length;i++)C[i].innerHTML="";this._OQFQ.innerHTML="";this.BD1I.innerHTML="";this.k65.toprow=0;for(var i=0;i<this.data.cols.length;i++)this.data.cols[i].sorted=false;this.data.$FF7=-1}finally{C=null;c=null}};domapi.comps.listgrid.beginUpdate=function(){if(this.h982u)return;if(domapi.trace)dump(this.toString()+'.beginUpdate()');this.h982u=true;this.data.inUpdate=true};domapi.comps.listgrid.endUpdate=function(){if(!this.h982u)return;if(domapi.trace)dump(this.toString()+'.endUpdate()');this.data.inUpdate=false;this.data.assert();this.assert();this.h982u=false;this.drawAndLayout()};domapi.comps.listgrid.assert=function(){if(domapi.trace)dump(this.toString()+'.assert()');var s,i,k$Vu,x3A00,B79,c,C;var p8Td=this.data;var H=this.BD1I;var Qg355=this.It93;var p=domapi.mJ00.listgrid;var P6c=this.k65;var R2899=false;try{p8Td.assert();var r7461=' <img src="'+domapi.theme.skin.M34h5.src+'">';var p18I=' <img src="'+domapi.theme.skin.a57.src+'">';for(i=0;i<P6c.visiblecols.length;i++){if(i>=H.childNodes.length){x3A00=document.createElement("DIV");R2899=true}else{x3A00=H.childNodes[i];R2899=false}x3A00.ub4=i;x3A00.innerHTML=p8Td.cols[P6c.visiblecols[i]].text;if(p8Td.visibleCol(i)==p8Td.$FF7)x3A00.innerHTML+=(p8Td.sortDir==0)?r7461:p18I;x3A00.DA_TYPE="LISTGRID_HEADER_COL";x3A00.className="DA_LISTGRID_HEADER_COL";if(R2899)H.appendChild(x3A00);if(i>=Qg355.childNodes.length){B79=document.createElement("DIV");R2899=true}else{B79=Qg355.childNodes[i];R2899=false}B79.innerHTML="&nbsp;";B79.ub4=Qg355.childNodes.length;B79.DA_TYPE="LISTGRID_COL";B79.className="DA_LISTGRID_COL";if(R2899)Qg355.appendChild(B79);p.buildColClass(this,i)}this.K5v();this.W75bJ()}finally{p8Td=null;H=null;Qg355=null;P6c=null}};domapi.comps.listgrid.K5v=function(){var i,hk7X,C,c,x3A00;var P6c=this.k65;var p8Td=this.data;var Qg355=this.It93;try{for(i=0;i<Qg355.childNodes.length;i++){var hk7X=p8Td.visibleCol(i);C=this.cols[i];c=p8Td.cols[hk7X];x3A00=C.S8e;if(x3A00&&x3A00.controlType!=c.controlType){x3A00.parentNode.removeChild(x3A00);x3A00=null;C.S8e=null}if(!C.S8e&&c.editable&&this.doAllowEdit){switch(c.controlType){case ctCheckbox:break;case ctCustom:break;case ctSelect:C.S8e=domapi.Elm({parent:this,type:"SELECT",x:0,y:0,w:50,h:20});x3A00=C.S8e;x3A00.style.fontSize="10px";if(c.yfL){var a;if(typeof(c.yfL)=="string")a=c.yfL.split(",");else a=c.yfL;var nF9vw;for(var I17H=0;I17H<a.length;I17H++){nF9vw=document.createElement("OPTION");if(typeof(a[I17H])=="string"){nF9vw.text=a[I17H];nF9vw.value=a[I17H]}else{nF9vw.text=a[I17H].text;nF9vw.value=a[I17H].value;if(a[I17H].selected)nF9vw.selected=a[I17H].selected}x3A00.add(nF9vw)}nF9vw=null}x3A00.onclick=function(E){if(!E)E=window.event;domapi.preventBubble(E)};break;case ctCombobox:break;case ctDatepicker:domapi.loadUnit("datepicker2");C.S8e=domapi.Datepicker2({parent:this,x:0,y:0,w:50,h:20});C.S8e.w7U1b.style.borderStyle="none";C.S8e.j8O30=hk7X;break;case ctText:case ctUnknown:C.S8e=domapi.Elm({parent:this,type:"INPUT",x:0,y:0,w:50,h:20});x3A00=C.S8e;x3A00.setAttribute("TYPE","TEXT");x3A00.onclick=function(E){if(!E)E=window.event;domapi.preventBubble(E)};break;case ctBrowseButton:domapi.assertUnit("button");C.S8e=domapi.Button({parent:this,x:0,y:0,w:2,h:2,text:"...",tabIndex:-1});break}if(C.S8e){x3A00=C.S8e;x3A00.controlType=c.controlType;x3A00.setB(0);x3A00.hide()}}domapi.mJ00.listgrid.buildColClass(this,i)}}catch(E){}finally{P6c=null;p8Td=null;Qg355=null;C=null;c=null;x3A00=null}};domapi.comps.listgrid.W75bJ=function(){if(domapi.trace)dump(this.toString()+'._assertRows()');var o691j=this.k65.viewablerows;var Y341,i375,C,uBUw,c,s,i;var p8Td=this.data;var Qg355=this.It93;var R=this._OQFQ;var P6c=this.k65;try{for(i=0;i<Qg355.childNodes.length;i++){var hk7X=p8Td.visibleCol(i);C=Qg355.childNodes[i];if(C.innerHTML=="&nbsp;"&&((this.doVirtualMode?o691j:this.k65.visiblerows)>0)){C.innerHTML="";C.style.display=""}if(domapi.isKHTML&&C.childNodes.length==1){if(C.getElementsByTagName("DIV").length==0)C.innerHTML=""}Y341=C.childNodes.length;i375=(this.doVirtualMode?o691j:this.k65.visiblerows)-Y341;C.Y7MFF=0;C.a1e="";for(k$Vu=C.childNodes.length;k$Vu<i375;k$Vu++){if(!this.h982u){uBUw=(Qg355.childNodes.length%2==0);c="DA_LG_"+this.id+"_ROW"+Qg355.childNodes.length+" DA_LG_"+this.id+"_CELL_"+i+"_"+Qg355.childNodes.length}else{uBUw=(C.Y7MFF%2==0);c="DA_LG_"+this.id+"_ROW"+C.Y7MFF+" DA_LG_"+this.id+"_CELL_"+i+"_"+C.Y7MFF}s='<div class="DA_LISTGRID_CELL '+c+' '+(uBUw?"DA_LISTGRID_ROW_ODD":"DA_LISTGRID_ROW_EVEN")+'">'+this.ICI(k$Vu,hk7X)+'&nbsp;</div>';if(!this.h982u)Qg355.innerHTML+=s;else{C.a1e+=s;C.Y7MFF++}}}R.Y7MFF=0;R.a1e="";for(k$Vu=R.childNodes.length;k$Vu<i375;k$Vu++){s='<div class="DA_LISTGRID_ROWBAR_CELL">&nbsp;</div>';if(!this.h982u)R.innerHTML+=s;else R.a1e+=s}}finally{p8Td=null;Qg355=null;R=null;P6c=null;C=null}};domapi.comps.listgrid.SC$3B=function(){if(domapi.trace)dump(this.toString()+'._showRowPersistentEditors() <--');var i,x3A00;var p8Td=this.data;try{for(i=0;i<p8Td.cols.length;i++)if(this.cols[i]){x3A00=this.cols[i].S8e;if(x3A00&&x3A00.tagName!="INPUT")this.g36Jy(this.currentRow,i)}if(domapi.trace)dump(this.toString()+'._showRowPersistentEditors() -->')}finally{p8Td=null;x3A00=null}};domapi.comps.listgrid.MDbuR=function(col){if(domapi.trace)dump(this.toString()+'._showRowPersistentEditor('+col+')');if(this.cols[col])try{var x3A00=this.cols[col].S8e;if(x3A00&&x3A00.tagName!="INPUT")this.g36Jy(this.currentRow,col)}finally{x3A00=null}};domapi.comps.listgrid.ICI=function(i,k$Vu){var p8Td=this.data;var E0E=p8Td.displayText(i,k$Vu);var C=p8Td.cols[k$Vu];if(C.controlType==ctCheckbox){var m=domapi.theme.skin.metrics.checkbox;var s=domapi.theme.skin._93Dq+'form/single_cb_';var pG32s;if(typeof(E0E)!="string")E0E=E0E.toString();var pG32s=E0E.toUpperCase().trim();if(this.enabled&&C.editable)s+="enabled_";else s+="disabled_";if(pG32s=="TRUE"||pG32s=="YES"||pG32s=="CHECKED")s+="checked.gif";else s+="cleared.gif";E0E='<img border="0" align="bottom" src="'+s+'" width="'+m.w+'" height="'+m.h+'" onclick="domapi.listgridCheckboxOnClick(this)">'}return E0E};domapi.listgridCheckboxOnClick=function(x3A00){domapi.mJ00.listgrid.lKi(x3A00)};domapi.comps.listgrid.$mu1=function(){if(domapi.trace)dump(this.toString()+'._renderCells()');var i,k$Vu,C,y,E0E;var p8Td=this.data;var Qg355=this.It93;var P6c=this.k65;var J70=P6c.toprow+(P6c.qBiu>0?0:0);var h85_=J70+P6c.viewablerows;try{if(domapi.trace)dump(this.toString()+'._renderCells() '+J70+' - '+h85_+' - '+P6c.viewablerows);for(i=0;i<P6c.visiblecols.length;i++){y=0;var C=Qg355.childNodes[i];var hk7X=p8Td.visibleCol(i);domapi.mJ00.listgrid.buildColClass(this,i);if(C)for(k$Vu=J70;k$Vu<h85_;k$Vu++){if(C.childNodes[y]){C.childNodes[y].innerHTML=this.ICI(k$Vu,hk7X)+'&nbsp;';if(this.ondrawcell)this.ondrawcell(C.childNodes[y],i,k$Vu,hk7X,y)}y++}}}finally{p8Td=null;Qg355=null;P6c=null;C=null}};domapi.comps.listgrid.h9i0x=function(){if(domapi.trace)dump(this.toString()+'._viewChanged()');this.getTopRow();this.getRowsViewable();domapi.mJ00.listgrid.Dv3$.apply(this)};domapi.comps.listgrid.s3kp=function(){if(domapi.trace)dump(this.toString()+'._dataChanged()');var P6c=this.k65;var Qg355=this.data;try{P6c.visiblerowsheight=Qg355.visibleRowsHeight();P6c.visiblecolswidth=Qg355.visibleColsWidth();P6c.visiblecols=Qg355.visibleCols();this.getRowbarWidth();this.getHeaderHeight();this.getRowsVisible();this.getVertScrollBarVisible();this.getHorzScrollBarVisible();this.h9i0x()}finally{P6c=null;Qg355=null}};domapi.comps.listgrid.refresh=function(){if(domapi.trace)dump(this.toString()+'.refresh()');this.beginUpdate();try{domapi.mJ00.listgrid.Dv3$.apply(this);this.r25=this.D7t.join().split(",");this.selectNone();this.s3kp();this.getRowsVisible();this.It93.innerHTML="";this._OQFQ.innerHTML=""}finally{this.endUpdate();setTimeout("document.getElementById('"+this.id+"').rbM()",10)}};domapi.comps.listgrid.rbM=function(){this.selected=[];for(var i=0;i<this.r25.length;i++)this.selectRow(this.r25[i],true,true)};domapi.comps.listgrid.selectAll=function(){if(domapi.trace)dump(this.toString()+'.selectAll()');if(!this.doShowSelection)return;var i,k$Vu;var Qg355=this.data;var c=".DA_LG_"+this.id;var __4=domapi.theme.fonts.selection.cssColor(true);try{for(i=0;i<Qg355.rows.length;i++){if(this.selectMode=="row"){if(this.selected.indexOf(i)<0){this.selectRow(i,true,false)}}else for(k$Vu=0;k$Vu<Qg355.cols.length;k$Vu++){if(this.selectMode=="col"){if(i==0){if(this.selected.indexOf(i)<0)this.selected.push(i)}}else{Qg355.rows[i].cells[k$Vu].wu6=domapi.css.addRule(c+"_CELL_"+k$Vu+"_"+i,__4,true)}}}}finally{Qg355=null}};domapi.comps.listgrid.selectNone=function(){if(domapi.trace)dump(this.toString()+'.selectNone()');var i,k$Vu;var c=".DA_LG_"+this.id;try{for(k$Vu=0;k$Vu<this.selected.length;k$Vu++){Y4U=this.Dc3h7(this.selected[k$Vu]);if(this.m$B3(Y4U)&&this._OQFQ.childNodes[Y4U])this._OQFQ.childNodes[Y4U].innerHTML=""}for(var i=this.selected.length-1;i>-1;i--){switch(this.selectMode){case "row":this.selectRow(this.selected[i],false);break;case "cell":break}}}finally{}};domapi.comps.listgrid.Dc3h7=function(i){var P6c=this.k65;var r=i-(this.doVirtualMode?P6c.toprow:0);try{if(domapi.trace)dump(this.toString()+'._physicalIndex('+i+') = '+r+'; toprow = '+P6c.toprow);return r}finally{P6c=null;r=null}};domapi.comps.listgrid.rowVisible=function(i){var P6c=this.k65;try{if(this.doVirtualMode)return(i>=P6c.toprow&&i<(P6c.toprow+P6c.viewablerows-1));else{var y=this.data.visibleRowTop(i);return(y>this.EAH4.scrollTop&&y<this.EAH4.scrollTop+this.offsetHeight-30)}}finally{P6c=null}};domapi.comps.listgrid.m$B3=function(i){var P6c=this.k65;try{var r=((!this.doVirtualMode)||(i>-1&&i<(P6c.toprow+P6c.viewablerows)));if(domapi.trace)dump(this.toString()+'._rowViewable('+i+') = '+r+'; toprow = '+P6c.toprow+'; viewablerows = '+P6c.viewablerows);return r}finally{P6c=null;r=null}};domapi.comps.listgrid.selectRow=function(i,b,N$j1){if(domapi.trace)dump(this.toString()+'.selectRow('+i+', '+(b==true)+', '+(N$j1==true)+')');var bM2;var Y4U=this.Dc3h7(i);if(Y4U<0||Y4U>this.data.rows.length-1)return;var k$Vu=this.selected.indexOf(i);this.data.rows[Y4U].selected=b;if(b&&k$Vu<0){if(this.m$B3(Y4U))for(bM2=0;bM2<this.cols.length;bM2++)if(this.It93.childNodes[bM2])domapi.css.addClass(this.It93.childNodes[bM2].childNodes[Y4U],"DA_SELECTION");this.selected.push(i)}else if(!b){if(this.m$B3(Y4U))for(bM2=0;bM2<this.cols.length;bM2++)if(this.It93.childNodes[bM2])domapi.css.removeClass(this.It93.childNodes[bM2].childNodes[Y4U],"DA_SELECTION");this.selected.deleteItem(k$Vu);if(!b&&this.ondeselectrow)this.ondeselectrow(i)}for(k$Vu=0;k$Vu<this.selected.length;k$Vu++){Y4U=this.Dc3h7(this.selected[k$Vu]);if(this.m$B3(Y4U)&&this._OQFQ.childNodes[Y4U])this._OQFQ.childNodes[Y4U].innerHTML=""}if(N$j1&&this.currentRow>-1){Y4U=this.Dc3h7(this.currentRow);if(this.m$B3(Y4U)&&this._OQFQ.childNodes[i]){this._OQFQ.childNodes[i].innerHTML='<img src="'+domapi.theme.skin.Rr91D.src+'">'}Y4U+=(this.doVirtualMode?this.k65.toprow:0);if(b&&!this.rowVisible(Y4U)){if(Y4U==this.k65.toprow&&this.k65.toprow>0)Y4U-=this.k65.viewablerows;Y4U=domapi.rangeInt(Y4U,0,this.k65.visiblerows-1);this.setTopRow(Y4U)}if(b&&this.onselectrow)this.onselectrow(this.currentRow)}this.SC$3B()};domapi.comps.listgrid.Q8$0=function(i){var r={cells:[]};var Y4U=this.Dc3h7(i);try{for(var bM2=0;bM2<this.cols.length;bM2++)r.cells.push(this.It93.childNodes[bM2].childNodes[Y4U]);return r}finally{r=null}};domapi.comps.listgrid.getVertScrollBarVisible=function(){var P6c=this.k65;try{if(!this.doVirtualMode)P6c.vertscrollbarvisible=P6c.visiblerowsheight>(P6c.viewporth-(P6c.horzscrollbarvisible?(P6c.mi7mO*2):0));else P6c.vertscrollbarvisible=P6c.visiblerows!=P6c.viewablerows;if(domapi.trace)dump(this.toString()+'.getVerticalScrollBarVisible() = '+P6c.vertscrollbarvisible+' '+[P6c.visiblerowsheight,P6c.viewporth]);return P6c.vertscrollbarvisible}finally{P6c=null}};domapi.comps.listgrid.getHorzScrollBarVisible=function(){var P6c=this.k65;try{P6c.horzscrollbarvisible=P6c.visiblecolswidth>(P6c.viewportw-(P6c.vertscrollbarvisible?(P6c.mi7mO+2):0));if(domapi.trace)dump(this.toString()+'.getHorzScrollBarVisible() = '+P6c.horzscrollbarvisible+' '+[P6c.visiblecolswidth,P6c.viewportw]);return P6c.horzscrollbarvisible}finally{P6c=null}};domapi.comps.listgrid.getHeaderHeight=function(){var P6c=this.k65;try{P6c.H$P=this.doShowHeader?(this.headerH-(domapi.isGecko?0:0)):0;if(domapi.trace)dump(this.toString()+'.getHeaderHeight() = '+P6c.H$P);return P6c.H$P}finally{P6c=null}};domapi.comps.listgrid.getRowbarWidth=function(){var P6c=this.k65;try{P6c.a4K=this.doShowRowbar?this.rowbarW:0;if(domapi.trace)dump(this.toString()+'.getRowbarWidth() = '+P6c.a4K);return P6c.a4K}finally{P6c=null}};domapi.comps.listgrid.getRowsViewable=function(){var P6c=this.k65;var r=0;var d3Mra=0;var Qg355=this.data;var top=P6c.toprow;var h=P6c.viewporth;try{if(P6c.horzscrollbarvisible)h-=P6c.mi7mO;var DO4b=0;if((this.gridlines=="horz")||(this.gridlines=="both"))DO4b=1;for(var i=top;i<Qg355.rows.length;i++)if(!Qg355.rows[i].hidden){d3Mra+=Qg355.rows[i].h+DO4b;if(d3Mra>=h)break;r++}if(top+r>Qg355.rows.length)r=Qg355.o4OX.length-top;P6c.viewablerows=r;if(domapi.trace)dump(this.toString()+'.getRowsViewable(V) = '+P6c.viewablerows);return P6c.viewablerows}finally{P6c=null;Qg355=null}};domapi.comps.listgrid.getRowsVisible=function(){var P6c=this.k65;try{P6c.visiblerows=this.data.visibleRowcount();if(domapi.trace)dump(this.toString()+'.getRowsVisible() = '+P6c.visiblerows);return P6c.visiblerows}finally{P6c=null}};domapi.comps.listgrid.setTopRow=function(index){this.EAH4.scrollTop=this.data.visibleRowTop(index);this.Fo0k7();this.q046()};domapi.comps.listgrid.getTopRow=function(){var i;var t=0;var h=0;var P6c=this.k65;var $3H60=(this.doVirtualMode?P6c.qBiu:this.EAH4.scrollTop)+(domapi.isGecko?P6c.H$P:P6c.H$P);var r=this.data.rows;try{for(i=0;i<r.length;i++)if(!r[i].hidden){h+=r[i].h;if(h>=($3H60)){P6c.toprow=t;if(domapi.trace)dump(this.toString()+'.getTopRow() = '+t);return P6c.toprow}t++}P6c.toprow=t;if(domapi.trace)dump(this.toString()+'.getTopRow() = '+t);return P6c.toprow}finally{P6c=null;r=null}};domapi.comps.listgrid.setGridlines=function(E0E){if(domapi.trace)dump(this.toString()+'.setGridlines('+E0E+') _inUpdate='+this.h982u);this.gridlines=E0E;domapi.css.removeClass(this,"GRIDLINES_VERT");domapi.css.removeClass(this,"GRIDLINES_HORZ");if(E0E=="both"||E0E=="horz")domapi.css.addClass(this,"GRIDLINES_HORZ");if(E0E=="both"||E0E=="vert")domapi.css.addClass(this,"GRIDLINES_VERT");if(this.doVirtualMode&&!this.h982u&&this.data.rows.length)this.refresh();this.SC$3B()};domapi.comps.listgrid.addCol=function(i2T25){if(domapi.trace)dump(this.toString()+'.addCol()');this.data.addCol(i2T25);if(!this.h982u)this.assert()};domapi.comps.listgrid.addRow=function(i2T25,del){if(domapi.trace)dump(this.toString()+'.addRow()');var h043Q=i2T25.constructor==Array;var p79q=i2T25.constructor==String;if(h043Q)i2T25={cells:i2T25};if(p79q)i2T25={cells:i2T25.split(domapi.rVal(del,","))};if(h043Q||p79q)for(var i=0;i<i2T25.cells.length;i++)i2T25.cells[i]={value:i2T25.cells[i]};this.data.addRow(i2T25);if(!this.h982u)this.assert()};domapi.comps.listgrid.deleteRow=function(i){if(domapi.trace)dump(this.toString()+'.deleteRow('+i+')');this.data.deleteRow(i)};domapi.comps.listgrid.g36Jy=function(r,c){var Qg355=this.data;try{if(r<0||c<0)return false;var x3A00,x,y,w,h,C,JAT72,V61$,E0E,k1_1;var P6c=this.k65;try{x3A00=this.cols[c].S8e}catch(E){return false}if(!x3A00||!this.doAllowEdit)return false;if(domapi.trace)dump(this.toString()+'._positionCellEditor('+r+','+c+')');JAT72=this.getRowbarWidth();V61$=this.getHeaderHeight();k1_1=this.EAH4;C=this.It93.childNodes[c].childNodes[r];if(!C)return false;x=this.It93.childNodes[c].offsetLeft+JAT72+1-k1_1.scrollLeft;y=C.offsetTop+V61$-k1_1.scrollTop;w=C.offsetWidth-3;h=C.offsetHeight-3;if((x+w)+k1_1.scrollLeft>(this.offsetWidth-JAT72)){var xh65X=k1_1.scrollLeft-this.offsetWidth-JAT72-w-10;if(xh65X<0)xh65X=0;k1_1.scrollLeft+=xh65X;x+=xh65X;this.scrollLeft=0}if(x3A00.$53){w+=domapi.theme.border.width*2;x3A00.onchange=function(E0E){domapi.mJ00.listgrid.$u7(this,E0E)}}else if(x3A00.controlType==ctBrowseButton){w=18;h+=2;x=x+this.cols[c].offsetWidth-18;x3A00.onclick=function(E){domapi.mJ00.listgrid.ny3M(E,r,c)}}else if(x3A00.controlType==ctSelect){x--;w+=3;x3A00.style.fontSize=(h-6)+"px";x3A00.onchange=function(E){domapi.mJ00.listgrid.MT01q(this,r,c)}}x3A00.setSize(w,h+2);x3A00.moveTo(x,y);var clip=[0,w+2,h+2,0];var $512=x+w-k1_1.scrollLeft;var X2j=this.offsetWidth-(P6c.vertscrollbarvisible?P6c.mi7mO:0);if($512>X2j)clip[1]=w-($512-X2j)-2;$512=y+h;X2j=this.offsetHeight-(P6c.horzscrollbarvisible?P6c.mi7mO:0);if($512>X2j)clip[2]=h-($512-X2j)-2;if(this.doShowRowbar&&x<JAT72)clip[3]=JAT72-x;if(this.doShowHeader&&y<P6c.H$P)clip[0]=P6c.H$P-y;x3A00.setClip(clip);E0E=Qg355.getValue(r,Qg355.visibleCol(c));if(x3A00.DJL20)x3A00.DJL20(E0E);else x3A00.value=E0E;x3A00.bringToFront();x3A00.show()}finally{Qg355=null;x3A00=null;k1_1=null;C=null}};domapi.comps.listgrid.editCell=function(){if(domapi.trace)dump(this.toString()+'.editCell()');var x3A00=null;try{this.g36Jy(this.currentRow,this.currentCol);try{this.fDB=this.cols[this.currentCol].S8e;x3A00=this.fDB}catch(E){return false}if(!x3A00)return false;try{x3A00.select();setTimeout("try{domapi.getElm('"+this.id+"').fDB.focus()}catch(E){}",200)}catch(E){}if((this.fDB.controlType==ctText)||(this.fDB.controlType==ctUnknown)){this._OQFQ.childNodes[this.currentRow].innerHTML='<img src="'+domapi.theme.skin.NLO31.src+'">';this.k65.JJm$3=true}if(this.onbeginedit)this.onbeginedit()}finally{x3A00=null}};domapi.comps.listgrid.cancelEdit=function(){if(domapi.trace)dump(this.toString()+'.cancelEdit()');if(!this.k65.JJm$3)return;this.fDB.hide();this.k65.JJm$3=false;this._OQFQ.childNodes[this.currentRow].innerHTML='<img src="'+domapi.theme.skin.Rr91D.src+'">';if(this.oncanceledit)this.oncanceledit()};domapi.comps.listgrid.commitEdit=function(){var xN4d4=true;if(domapi.trace)dump(this.toString()+'.commitEdit()');if(!this.k65.JJm$3)return xN4d4;this._OQFQ.childNodes[this.currentRow].innerHTML='<img src="'+domapi.theme.skin.Rr91D.src+'">';var r=this.currentRow;var c=this.currentCol;if(r<0||c<0)return false;var x3A00=this.fDB;try{if(this.onendedit)xN4d4=this.onendedit(this.data.rows[r].cells[this.data.visibleCol(c)].value,x3A00.value);if(xN4d4){x3A00.hide();this.k65.JJm$3=false;this.data.rows[r].cells[this.data.visibleCol(c)].value=x3A00.value;this.data.rows[r].cells[this.data.visibleCol(c)].text=x3A00.value;this.It93.childNodes[c].childNodes[r].innerHTML=x3A00.value}return xN4d4}finally{x3A00=null}};domapi.comps.listgrid.swapCols=function(i,k$Vu){var bM2;var Qg355=this.data;var c=this.cols;var Nu5=this.It93.childNodes;var _02e=domapi.mJ00.listgrid;try{if(i==k$Vu)return;if(!c[i]||!c[k$Vu])return;if(i>k$Vu){var t=i;i=k$Vu;k$Vu=t}Qg355.swapCols(Qg355.visibleCol(i),Qg355.visibleCol(k$Vu));c[i].ub4=k$Vu;c[k$Vu].ub4=i;domapi.swapNodes(c[i],c[k$Vu]);Nu5[i].ub4=k$Vu;Nu5[k$Vu].ub4=i;domapi.swapNodes(Nu5[i],Nu5[k$Vu]);if(!this.h982u){for(bM2=0;bM2<c.length;bM2++)_02e.buildColClass(this,bM2);if(this.oncolswap)this.oncolswap(i,k$Vu)}}finally{Qg355=null;c=null;Nu5=null}};domapi.comps.listgrid.R624=function(i,dir){try{var Qg355=this.data;var C=Qg355.cols[Qg355.visibleCol(i)];if(C&&C.sortable){C.sortDir=domapi.rInt(dir,1);if(Qg355.cols[Qg355.$FF7])Qg355.cols[Qg355.$FF7].sorted=false;Qg355.sort(C.fieldName,C.sortDir);C.sorted=true;this.refresh()}}finally{Qg355=null;C=null}};domapi.comps.listgrid.MV9=function(x3A00,E){if(this.doColResize){var b=this.resizeBdr;var VlX0n=domapi.isGecko?E.layerX:event.offsetX;return VlX0n>=(x3A00.offsetWidth-b)}else return false};domapi.mJ00.listgrid.buildColClass=function(k1_1,i){if(domapi.trace)dump(k1_1.toString()+'.buildColClass('+k1_1+', '+i+')');var p8Td=k1_1.data;var l=0;var hk7X=p8Td.visibleCol(i);var w=p8Td.cols[hk7X].w;var a=p8Td.cols[hk7X].textAlign;try{for(var k$Vu=0;k$Vu<i;k$Vu++)l+=p8Td.cols[p8Td.visibleCol(k$Vu)].w;with(k1_1.It93.childNodes[i].style){width=w+"px";left=l+"px";textAlign=a}if((domapi.isStrict&&domapi.isIE)||domapi.isKHTML)w-=8;with(k1_1.BD1I.childNodes[i].style){width=w+"px";left=l+"px";textAlign=p8Td.cols[hk7X].headerAlign;}k1_1.MDbuR(i)}finally{p8Td=null}};domapi.mJ00.listgrid.qw33W=function(E){if(domapi.isGecko&&!E)return;var x3A00=domapi.findTarget(E,"LISTGRID");try{if(!x3A00)return;if(x3A00.k65.JJm$3)x3A00.cancelEdit();if(x3A00.yXx6)return;x3A00.yXx6=true;if(domapi.trace)dump(this.toString()+'.doscroll()');if(!x3A00.doVirtualMode){x3A00.q046();if(this.onscroll)this.onscroll()}else{if(x3A00.e$7)clearTimeout(x3A00.W_r4);x3A00.e$7=setTimeout('document.getElementById("'+x3A00.id+'").Fo0k7()',100)}x3A00.SC$3B();x3A00.yXx6=false}finally{x3A00=null}};domapi.mJ00.listgrid.Fo0k7=function(){if(domapi.trace)dump(this.toString()+'._doscroll()');var Y4U,bM2;var C=this.EAH4;var P6c=this.k65;var R=this._OQFQ;var __4=domapi.theme.fonts.selection.cssColor();var s=this.selected;try{if(C.scrollTop!=P6c.qBiu){for(k$Vu=0;k$Vu<s.length;k$Vu++){Y4U=this.Dc3h7(s[k$Vu]);if(this.m$B3(Y4U)){for(bM2=0;bM2<this.cols.length;bM2++)domapi.css.removeClass(this.It93.childNodes[bM2].childNodes[Y4U],"DA_SELECTION");if(R.childNodes[Y4U])R.childNodes[Y4U].innerHTML=""}}P6c.qBiu=C.scrollTop;this.h9i0x();if(P6c.viewablerows>0)this.$mu1();for(k$Vu=0;k$Vu<s.length;k$Vu++){Y4U=this.Dc3h7(s[k$Vu]);if(this.m$B3(Y4U)){for(bM2=0;bM2<this.cols.length;bM2++)domapi.css.addClass(this.It93.childNodes[bM2].childNodes[Y4U],"DA_SELECTION");if(Y4U==this.currentRow&&R.childNodes[Y4U])R.childNodes[Y4U].innerHTML='<img src="'+domapi.theme.skin.Rr91D.src+'">'}}}else{if(C.scrollLeft!=P6c.Uxex){this.q046();P6c.Uxex=C.scrollLeft}}if(this.onscroll)this.onscroll()}finally{C=null;P6c=null;R=null;s=null}};domapi.mJ00.listgrid.kMo=function(E){var x3A00=domapi.findTarget(E,"LISTGRID_HEADER_COL");try{if(!x3A00)return;var r=domapi.findTarget(E,"LISTGRID");var p=domapi.mJ00.listgrid;if(r.k65.Hs00||!r.enabled||(domapi.customDrag&&domapi.customDrag.inDrag))return;if(r.doRollover&&!r.MV9(x3A00,E)&&!r.k65.u1Xd){domapi.css.addClass(x3A00,"DA_LISTGRID_HEADER_COL_OVER")}else p.q_2M(E)}finally{x3A00=null;r=null;p=null}};domapi.mJ00.listgrid.$WY=function(E){var x3A00=domapi.findTarget(E,"LISTGRID_HEADER_COL");try{if(!x3A00)return;var r=domapi.findTarget(E,"LISTGRID");var p=domapi.mJ00.listgrid;if(r.k65.Hs00||!r.enabled||(domapi.customDrag&&domapi.customDrag.inDrag))return;var s=x3A00.style;if(r.doColResize){if(r.MV9(x3A00,E)&&!r.k65.u1Xd){if(s.cursor!=domapi.cursors.vertBeam){p.q_2M(E);s.cursor=domapi.cursors.vertBeam}}else{if(s.cursor!="default"){p.kMo(E);s.cursor="default"}}}else s.cursor="default"}finally{x3A00=null;r=null;p=null;s=null}};domapi.mJ00.listgrid.q_2M=function(E){var x3A00=domapi.findTarget(E,"LISTGRID_HEADER_COL");try{if(!x3A00)return;var r=domapi.findTarget(E,"LISTGRID");if(r.k65.Hs00||r.k65.u1Xd)return;domapi.css.removeClass(x3A00,"DA_LISTGRID_HEADER_COL_OVER")}finally{x3A00=null;r=null}};domapi.mJ00.listgrid.xYq=function(E){var x3A00=domapi.findTarget(E,"LISTGRID_HEADER_COL");try{if(x3A00){var r=domapi.findTarget(E,"LISTGRID");if(r.enabled&&r.doDepress&&!r.MV9(x3A00,E))domapi.css.addClass(x3A00,"DA_LISTGRID_HEADER_COL_DOWN")}}finally{x3A00=null;r=null}};domapi.mJ00.listgrid.Ykd=function(E){var x3A00=domapi.findTarget(E,"LISTGRID_HEADER_COL");var r=domapi.findTarget(E,"LISTGRID");var Qg355=r.data;try{if(x3A00){domapi.css.removeClass(x3A00,"DA_LISTGRID_HEADER_COL_DOWN");if(r.doColSort&&!r.k65.Hs00&&!r.k65.u1Xd){var C=Qg355.cols[Qg355.visibleCol(domapi.getNodeIndex(x3A00))];if(C&&C.sortable){C.sortDir=domapi.rInt(C.sortDir,1);C.sortDir=1-C.sortDir;domapi.customDrag.container.cancelCustomDrag({});r.R624(domapi.getNodeIndex(x3A00),C.sortDir)}}if(r.onheaderclick)r.onheaderclick(domapi.getNodeIndex(x3A00))}r.g$G_()}finally{x3A00=null;r=null;Qg355=null;C=null}};domapi.mJ00.listgrid.findCell=function(E){var c=domapi.findTarget(E,"DIV");try{while(c){if(c.parentNode&&c.parentNode.DA_TYPE&&c.parentNode.DA_TYPE=="LISTGRID_COL")return c;else c=c.parentNode}return null}finally{c=null}};domapi.mJ00.listgrid.Dv3$=function(){this.D7t=[];for(var i=0;i<this.data.rows.length;i++)if(this.data.rows[i].selected)this.D7t.push(i)};domapi.mJ00.listgrid.n245=function(E){var r=domapi.findTarget(E,"LISTGRID");var shiftKey=domapi.isIE?event.shiftKey:E.shiftKey;var ctrlKey=domapi.isIE?event.ctrlKey:E.ctrlKey;var c=domapi.mJ00.listgrid.findCell(E);try{if(!r||!c||!r.enabled)return;if(domapi.trace)dump(r.toString()+'.dodataclick()');var C=c.parentNode;var x=C.ub4;var y=domapi.getNodeIndex(c)+(r.doVirtualMode?r.k65.toprow:0);var i=r.Dc3h7(r.currentRow);if(r.m$B3(i)&&r._OQFQ.childNodes[i])r._OQFQ.childNodes[i].innerHTML='';var U2R=y!=r.currentRow;var c65c0=x!=r.currentCol;var FD4=r.currentRow;if(U2R||c65c0){if(!r.commitEdit())return};r.currentRow=y;r.currentCol=x;if((!(shiftKey||ctrlKey)&&r.doMultiSelect)||!r.doMultiSelect)r.selectNone();if((ctrlKey&&r.selected.indexOf(y)>-1)&&(r.doAllowNoSelect||r.selected.length>1)){r.selectRow(y,false);return}if(shiftKey&&r.doMultiSelect&&r.currentRow>-1){var _b1tk,P68na;if(FD4<y){_b1tk=FD4;P68na=y}else{_b1tk=y;P68na=FD4}for(var i=_b1tk;i<=P68na;i++)if(i!=y)r.selectRow(i,true,true)}r.selectRow(y,true,true);if(!U2R&&!c65c0){if(r.enabled&&r.doAllowEdit&&r.data.cols[r.data.visibleCol(x)].editable){if(r.onallowedit&&!r.onallowedit(x))return;r.editCell()}}}catch(E){}finally{r=null;c=null;C=null}};domapi.mJ00.listgrid.pR7I3=function(E){var x3A00=domapi.getTarget(E,"LISTGRID_COL");var r=domapi.findTarget(E,"LISTGRID");var p8Td=0;if(x3A00&&r){if(!E)E=window.event;if(E.wheelDelta)p8Td=E.wheelDelta;else if(E.H5h_3){p8Td=-E.H5h_3;if(p8Td==32768)p8Td=120;else if(p8Td==-32768)p8Td=-120}if(domapi.isIE){if(E.wheelDelta<0)r.EAH4.doScroll("down");else r.EAH4.doScroll("up")}else{r.EAH4.scrollTop-=p8Td;if(!r.doVirtualMode){r.q046()}else{if(r.e$7)clearTimeout(r.W_r4);r.e$7=setTimeout('document.getElementById("'+r.id+'").Fo0k7()',100)}}domapi.preventBubble(E)}};domapi.mJ00.listgrid.i$144=function(E){var bM2=domapi.isIE?event.keyCode:E.which;var x3A00=domapi.getTarget(E);var r=x3A00.o55Q;if(!r)r=domapi.findTarget(E,"LISTGRID");var x=r.currentCol;var Qg355=r.data;var i$4_=false;var i;var shiftKey=domapi.isIE?event.shiftKey:E.shiftKey;var ctrlKey=domapi.isIE?event.ctrlKey:E.ctrlKey;try{if(!r.enabled)return;if(domapi.trace)dump(this.toString()+'.dokeydown('+bM2+')');if(bM2==113&&r.enabled&&r.doAllowEdit&&Qg355.cols[Qg355.visibleCol(x)].editable){if(r.onallowedit&&!r.onallowedit(x))return;r.editCell();i$4_=true}if(bM2==27&&r.k65.JJm$3)r.cancelEdit();if(bM2==13&&r.k65.JJm$3)r.commitEdit();if(!r.k65.JJm$3){if(bM2==33||bM2==34){if(bM2==33)i=r.currentRow-r.k65.viewablerows;if(bM2==34)i=r.currentRow+r.k65.viewablerows;r.selectNone();r.currentRow=domapi.rangeInt(i,0,r.k65.visiblerows-1);r.selectRow(r.currentRow,true,true);i$4_=true}if(bM2==35&&ctrlKey){r.EAH4.scrollTop=Qg355.visibleRowsHeight();r.q046();r.selectNone();r.currentRow=Qg355.rows.length-1;r.selectRow(r.currentRow,true,true)}if(bM2==35&&!ctrlKey)r.currentCol=r.cols.length-1;if(bM2==36&&ctrlKey){r.EAH4.scrollTop=0;r.q046();r.selectNone();r.currentRow=0;r.selectRow(r.currentRow,true,true)}if(bM2==36&&!ctrlKey){r.currentCol=0;i$4_=true}if(bM2==37&&r.currentCol>0){r.currentCol--;i$4_=true}if(bM2==38&&r.currentRow>0){if((!(shiftKey||ctrlKey)&&r.doMultiSelect)||!r.doMultiSelect)r.selectNone();r.currentRow--;r.selectRow(r.currentRow,true,true);i$4_=true}if(bM2==39&&r.currentCol<(r.cols.length-1)){r.currentCol++;i$4_=true}if(bM2==40&&r.currentRow<Qg355.rows.length-1){if(r.k65.JJm$3)r.commitEdit();if((!(shiftKey||ctrlKey)&&r.doMultiSelect)||!r.doMultiSelect)r.selectNone();r.currentRow++;r.selectRow(r.currentRow,true,true);i$4_=true}if(bM2==65&&ctrlKey&&r.doMultiSelect){r.selectAll();i$4_=true}if(bM2==27){r.selectNone();r.selectRow(r.currentRow,true,true)}}if(i$4_){if(E&&E.preventDefault)E.preventDefault();return false}}catch(E){}finally{r=null;x3A00=null;Qg355=null}};domapi.mJ00.listgrid.lKi=function(x3A00){var R=domapi.findParent(x3A00,"LISTGRID");try{if(!R||!x3A00||!R.enabled||R.k65.JJm$3)return;var enabled=x3A00.src.indexOf('enabled')>-1;var checked=x3A00.src.indexOf('checked')>-1;var grayed=x3A00.src.indexOf('grayed')>-1;if(!enabled)return;var r=R.currentRow;var c=R.currentCol;if(r<0||c<0)return;if(checked)x3A00.src=x3A00.src.replace(new RegExp("checked"),"cleared");else if(grayed)x3A00.src=x3A00.src.replace(new RegExp("grayed"),"checked");else x3A00.src=x3A00.src.replace(new RegExp("cleared"),"checked");var o9N=R.data.rows[r].cells[R.data.visibleCol(c)];switch(o9N.value){case true:o9N.value=false;break;case false:o9N.value=true;break;case 1:o9N.value=0;break;case 0:o9N.value=1;break;case "":o9N.value=true;break;case "true":o9N.value="false";break;case "True":o9N.value="False";break;case "TRUE":o9N.value="FALSE";break;case "false":o9N.value="true";break;case "False":o9N.value="True";break;case "FALSE":o9N.value="TRUE";break;case "yes":o9N.value="no";break;case "Yes":o9N.value="No";break;case "YES":o9N.value="NO";break;case "no":o9N.value="yes";break;case "No":o9N.value="Yes";break;case "NO":o9N.value="YES";break}o9N.text=String(o9N.value);if(R.onendedit)R.onendedit()}finally{R=null;o9N=null}};domapi.mJ00.listgrid.ny3M=function(E,r,c){if(!E)E=window.event;var R=domapi.findTarget(E,"LISTGRID");try{if(!R||!R.enabled||R.k65.JJm$3)return;if(r<0||c<0)return;var QCk=R.data.visibleCol(c);var l7X=R.Dc3h7(r);if(R.data.cols[QCk].onbeginedit)R.data.cols[QCk].onbeginedit(l7X,QCk);domapi.preventBubble(E)}finally{R=null;o9N=null}};domapi.mJ00.listgrid.MT01q=function(x3A00,r,c){var R=domapi.findParent(x3A00,"LISTGRID");try{if(!R||!x3A00||!R.enabled||R.k65.JJm$3)return;if(r<0||c<0)return;var o9N=R.data.rows[r].cells[R.data.visibleCol(c)];o9N.value=x3A00.value;o9N.text=x3A00.options[x3A00.selectedIndex].text;R.It93.childNodes[c].childNodes[r].innerHTML=x3A00.options[x3A00.selectedIndex].text;if(R.onendedit)R.onendedit()}finally{R=null;o9N=null}};domapi.mJ00.listgrid.$u7=function(x3A00,E0E){var R=domapi.findParent(x3A00,"LISTGRID");var x3A00=domapi.findParent(x3A00,"DATEPICKER2");try{if(!R||!x3A00||!R.enabled||R.k65.JJm$3)return;R.data.setValue(R.currentRow,x3A00.j8O30,E0E);R.data.setText(R.currentRow,x3A00.j8O30,x3A00.getValue());if(R.onendedit)R.onendedit();R.refresh()}finally{R=null;x3A00=null}};domapi.mJ00.listgrid.ondragallow=function(i2T25){var x3A00=domapi.findParent(domapi.customDrag.elm,"LISTGRID_HEADER_COL");var C=domapi.customDrag;var p=domapi.findParent(C.container,"LISTGRID");try{C.dragThreshold=4;C.col=x3A00;if(!x3A00||!p||!p.enabled||p.k65.Hs00||p.k65.u1Xd)return false;if(p.MV9(x3A00,i2T25.E)&&p.doColResize){p.k65.Hs00=true;p.H359=false;p.UR6Y=x3A00.ub4;C.dragThreshold=0;C.i$X=x3A00.offsetLeft+x3A00.offsetWidth;return true}if(!p.MV9(x3A00,i2T25.E)&&p.doColMove&&!p.k65.Hs00&&!p.k65.u1Xd){p.H359=true;p.o2R7=x3A00.ub4;C.i$X=x3A00.offsetLeft+x3A00.offsetWidth;for(var i=0;i<p.cols.length;i++)if(p.cols[i]!=x3A00)domapi.css.removeClass(p.cols[i],"DA_LISTGRID_HEADER_COL_OVER");return true}p.style.cursor="default";x3A00.style.cursor="default";return false}finally{x3A00=null;C=null;p=null}};domapi.mJ00.listgrid.ondragstart=function(i2T25){var C=domapi.customDrag;var p=domapi.findParent(C.container,"LISTGRID");if(p.H359)p.k65.u1Xd=true;C=null;p=null};domapi.mJ00.listgrid.ondragmove=function(i2T25){var x3A00=domapi.findParent(i2T25.source,"LISTGRID_HEADER_COL");if(!x3A00)return;var C=domapi.customDrag;var p=domapi.findParent(C.container,"LISTGRID");try{if(p.k65.Hs00){var b=p.Qc4i;if(!b.showing){b.show();b.showing=true;b.setH(p.getH());b.setY(0)}C.Xo9=i2T25.dX+C.i$X+2;if(C.Xo9-x3A00.offsetLeft<p.minColWidth){C.Xo9=x3A00.offsetLeft+p.minColWidth}b.setX(C.Xo9-p.EAH4.scrollLeft)}if(p.k65.u1Xd){var k1_1=p.V59nd;if(!k1_1.showing){k1_1.innerHTML=C.col.innerHTML;k1_1.style.display="";k1_1.showing=true;k1_1.setSize(C.col.offsetWidth,C.col.offsetHeight)}C.Xo9=i2T25.dX+C.i$X-(C.col.offsetWidth/1);k1_1.setX(C.Xo9-p.EAH4.scrollLeft)}}finally{x3A00=null;C=null;p=null;k1_1=null}};domapi.mJ00.listgrid.ondragend=function(i2T25){var i;var C=domapi.customDrag;var p=domapi.findParent(C.container,"LISTGRID");var c=p.cols;var Qg355=p.data;if(domapi.trace)dump(p.toString()+'.ondragend()');try{if(p.k65.Hs00){var x3A00=C.col;if(!x3A00)return;p.k65.Hs00=false;p.Qc4i.hide();p.Qc4i.showing=false;p.style.cursor="default";x3A00.style.cursor="default";Qg355.cols[Qg355.visibleCol(x3A00.ub4)].w+=(C.cursorX-C.cursorStartX);if(Qg355.cols[Qg355.visibleCol(x3A00.ub4)].w<p.minColWidth)Qg355.cols[Qg355.visibleCol(x3A00.ub4)].w=p.minColWidth;for(i=x3A00.ub4;i<c.length;i++)domapi.mJ00.listgrid.buildColClass(p,i);p.layout();return}if(p.k65.u1Xd){var x,Y_94,Oc978;var k1_1=p.V59nd;p.k65.u1Xd=false;p.SC$3B();if(!k1_1.showing)return;k1_1.showing=false;for(var i=0;i<c.length;i++)domapi.css.removeClass(c[i],"DA_LISTGRID_HEADER_COL_OVER");x=k1_1.getX();Y_94=p.o2R7;Oc978=Y_94;if(x<0)Oc978=0;if(x>c[c.length-1].offsetLeft)Oc978=c.length-1;for(i=0;i<c.length-1;i++)if((x>c[i].offsetLeft)&&(x<c[i].offsetLeft+c[i].offsetWidth)){Oc978=i+1;break}if(Oc978!=Y_94){p.beginUpdate();var dir=(Y_94<Oc978)?1:-1;while(Oc978!=Y_94){p.swapCols(Y_94,Y_94+dir);Y_94+=dir;if((Oc978-Y_94)==1)break}p.endUpdate();var _02e=domapi.mJ00.listgrid;for(bM2=0;bM2<c.length;bM2++)_02e.buildColClass(p,bM2);if(p.oncolswap)p.oncolswap(i,k$Vu)}k1_1.style.display="none"}}finally{x3A00=null;k1_1=null;p=null;Qg355=null;C=null;c=null}};domapi.comps.listgrid.ondragallow=function(i2T25){var x3A00=domapi.findChildOfParent(domapi.customDrag.elm,"LISTGRID_COL");var p=domapi.customDrag.container;try{var o7b=x3A00&&(p!=x3A00)&&p.doAllowDrag&&!p.k65.u1Xd&&!p.k65.Hs00&&!p.k65.JJm$3;return o7b}finally{x3A00=null;p=null}};domapi.comps.listgrid.ondragstart=function(i2T25){var p8Td=domapi.customDrag;try{p8Td.elm=domapi.findChildOfParent(p8Td.elm,"LISTGRID_COL");if(!p8Td.elm)p8Td.container.cancelCustomDrag();var r=domapi.findParent(p8Td.elm,"LISTGRID");r.J4q=domapi.getNodeIndex(p8Td.elm);r.J4q+=r.k65.toprow;p8Td.J4q=r.J4q}finally{p8Td=null}};domapi.comps.listgrid.loadFromJson=function(R4C0){this.$tX(R4C0)};domapi.comps.listgrid.$tX=function(R4C0){var Qg355=this.data;try{if(domapi.trace)dump(this.toString()+'._loadFromJson()');this.clear();Qg355.loadFromJson(R4C0,true);if(Qg355.rows.length>0)this.currentRow=0;if(Qg355.cols.length>0)this.currentCol=0;setTimeout('document.getElementById("'+this.id+'").refresh();',100)}finally{Qg355=null}};domapi.comps.listgrid.loadFromJsonUrl=function(url){this.k45H(url)};domapi.comps.listgrid.k45H=function(url){if(domapi.trace)dump(this.toString()+'._loadFromJsonUrl("'+url+'")');var k$Vu=domapi.urlToJson(url);this.loadFromJson(k$Vu);k$Vu=null};domapi.comps.listgrid.loadFromCsv=function(s){this.J0uN$(s)};domapi.comps.listgrid.J0uN$=function(s){var Qg355=this.data;try{if(domapi.trace)dump(this.toString()+'._loadFromCsv()');this.clear();Qg355.loadFromCsv(s,true);if(Qg355.rows.length>0)this.currentRow=0;if(Qg355.cols.length>0)this.currentCol=0;this.refresh();if(!this.doAllowNoSelect&&this.currentRow==0)setTimeout('document.getElementById("'+this.id+'").selectRow(0,true,true)',10)}finally{Qg355=null}};domapi.comps.listgrid.loadFromCsvUrl=function(url){this.lH72(url)};domapi.comps.listgrid.lH72=function(url){if(domapi.trace)dump(this.toString()+'._loadFromCsvUrl("'+url+'")');var k$Vu=domapi.urlToCsv(url);this.loadFromCsv(k$Vu);k$Vu=null};domapi.comps.listgrid.loadFromXml=function(xR6,mvq4){this.I7f1A(xR6)};domapi.comps.listgrid.I7f1A=function(xR6,mvq4){var Qg355=this.data;try{if(domapi.trace)dump(this.toString()+'._loadFromXml()');this.clear();Qg355.loadFromXml(xR6,mvq4,true);if(Qg355.rows.length>0)this.currentRow=0;if(Qg355.cols.length>0)this.currentCol=0;this.refresh();if(!this.doAllowNoSelect&&this.currentRow==0)setTimeout('document.getElementById("'+this.id+'").selectRow(0,true,true)',10)}finally{Qg355=null}};domapi.comps.listgrid.loadFromXmlUrl=function(url,mvq4){this.m$1(url,mvq4)};domapi.comps.listgrid.m$1=function(url,mvq4){var Qg355=this.data;try{if(domapi.trace)dump(this.toString()+'._loadFromXmlUrl("'+url+'")');this.clear();Qg355.loadFromXmlUrl(url,mvq4,true);if(Qg355.rows.length>0)this.currentRow=0;if(Qg355.cols.length>0)this.currentCol=0;this.refresh();if(!this.doAllowNoSelect&&this.currentRow==0)setTimeout('document.getElementById("'+this.id+'").selectRow(0,true,true)',10)}finally{Qg355=null}};domapi.mJ00.listgrid.w503=function(Y8H4){var s="";var b="\n";var P6c=Y8H4.k65;$fN9=function(_8xC,E0E){return _8xC+" : "+E0E+b};s+="state dump of grid "+Y8H4.id+b+"-----------------------------"+b+$fN9("selected",'['+Y8H4.selected+']')+$fN9("currentRow",Y8H4.currentRow)+$fN9("currentCol",Y8H4.currentCol)+$fN9("sbw",P6c.mi7mO)+$fN9("viewportw",P6c.viewportw)+$fN9("viewporth",P6c.viewporth)+$fN9("toprow",P6c.toprow)+$fN9("rowbarwidth",P6c.a4K)+$fN9("visiblerows",P6c.visiblerows)+$fN9("viewablerows",P6c.viewablerows)+$fN9("headerheight",P6c.H$P)+$fN9("scrolltop",P6c.qBiu)+$fN9("scrollleft",P6c.Uxex)+$fN9("visiblerowsheight",P6c.visiblerowsheight)+$fN9("visiblecolswidth",P6c.visiblecolswidth)+$fN9("vertscrollbarvisible",P6c.vertscrollbarvisible)+$fN9("horzscrollbarvisible",P6c.horzscrollbarvisible)+$fN9("inresize",P6c.Hs00)+$fN9("inedit",P6c.JJm$3)+$fN9("inmove",P6c.u1Xd)+$fN9("lastheaderclip",'['+P6c.p64+']')+$fN9("lastdataclip",'['+P6c.GQip5+']');P6c=null;return s};domapi.mJ00.listgrid.dumpState=function(Y8H4){var s="";var b="</td></tr><br />";var P6c=Y8H4.k65;$fN9=function(_8xC,E0E){return "<tr><td>]"+_8xC+"&nbsp;</td><td>"+E0E+"</td></tr>"};s+='<table cellpadding="0" cellspacing="0" border="0">'+$fN9("selected",'['+Y8H4.selected+']')+$fN9("currentRow",Y8H4.currentRow)+$fN9("currentCol",Y8H4.currentCol)+$fN9("sbw",P6c.mi7mO)+$fN9("viewportw",P6c.viewportw)+$fN9("viewporth",P6c.viewporth)+$fN9("toprow",P6c.toprow)+$fN9("rowbarwidth",P6c.a4K)+$fN9("visiblerows",P6c.visiblerows)+$fN9("viewablerows",P6c.viewablerows)+$fN9("headerheight",P6c.H$P)+$fN9("scrolltop",P6c.qBiu)+$fN9("scrollleft",P6c.Uxex)+$fN9("visiblerowsheight",P6c.visiblerowsheight)+$fN9("visiblecolswidth",P6c.visiblecolswidth)+$fN9("vertscrollbarvisible",P6c.vertscrollbarvisible)+$fN9("horzscrollbarvisible",P6c.horzscrollbarvisible)+$fN9("inresize",P6c.Hs00)+$fN9("inedit",P6c.JJm$3)+$fN9("inmove",P6c.u1Xd)+$fN9("lastheaderclip",'['+P6c.p64+']')+$fN9("lastdataclip",'['+P6c.GQip5+']')+'</table>';dump("");dump("================= GRID STATE ==================");dump(s);dump("===============================================");P6c=null};