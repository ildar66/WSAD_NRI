/*
Copyright (c) Nebiru Software 2001, 2005
  Compressed and obfuscated by JSCruncher Pro.
  http://domapi.com/jscruncherpro
*/
var tptWindow=0;var tptHighlight=1;var tptSelection=2;domapi.loadUnit("sysutils");domapi.loadUnit("customdrag");domapi.registerComponent("tree");domapi.Tree=function(i2T25){return domapi.comps.tree.constructor(i2T25)};domapi.comps.tree.constructor=function(i2T25){var x3A00=domapi.Component(i2T25,"tree");try{x3A00.expanded=true;x3A00.nodes=[];x3A00.selected=null;x3A00.rendered=true;var p=domapi.mJ00.tree;domapi.addEvent(x3A00,"mouseover",p.T3S);domapi.addEvent(x3A00,"mouseout",p.C06);domapi.addEvent(x3A00,"click",p.e2xtH);domapi.addEvent(x3A00,"dblclick",p.qALD0);x3A00.turnOnCustomDrag({});x3A00.style.overflow="auto";x3A00.setValue("");domapi.hl1(x3A00);domapi.addEvent(domapi.isIE?x3A00:x3A00.r40s5,"keydown",p.i$144);return x3A00}finally{x3A00=null}};domapi.comps.tree.Gk8HS=function(){var Fyr,i;var kLb=function(_8xC){for(var i=0;i<_8xC.nodes.length;i++){kLb(_8xC.nodes[i]);_8xC.nodes[i].nodes=[];_8xC.nodes[i].img=null;_8xC.nodes[i].nodes=null;_8xC.nodes[i].JR_g3=null;_8xC.nodes[i].m2rC=null;_8xC.nodes[i].parent=null}};kLb(this);kLb=null;this.nodes=[];this.nodes=null;this.selected=null;Fyr=this.getElementsByTagName("DIV");for(i=0;i<Fyr.length;i++){Fyr[i].parent=null;Fyr[i].nodes=[];Fyr[i].nodes=null;Fyr[i].JR_g3=null;Fyr[i].img=null;Fyr[i].m2rC=null}Fyr=[];Fyr=null};domapi.comps.tree.Q43hR=function(){this.G23()};domapi.comps.tree.G23=function(){var t=domapi.theme;var __4=t.fonts;var s=this.style;try{var b=this.doBorder?parseInt(t.border.width):0;this.setB(b);this.setColor(__4.window.color);this.setBgColor(this.doBGFill?__4.window.bgcolor:"transparent");s.borderStyle=this.doBorder?t.border.solid:"none";s.borderColor=t.border.getInset()}finally{t=null;__4=null;s=null}};domapi.comps.tree.MR9=function(w,h){};domapi.comps.tree.refresh=function(_8xC,all){var kLb=function(i64R,_8xC,all){for(var i=0;i<_8xC.nodes.length;i++)if(_8xC.nodes[i].rendered){i64R.renderNode(_8xC.nodes[i],_8xC,true);if(all)kLb(i64R,_8xC.nodes[i],all)}};_8xC=_8xC?_8xC:this;all=domapi.rBool(all,true);kLb(this,_8xC,all);kLb=null};domapi.comps.tree.addNode=function(i2T25){var p=i2T25["parent"]?i2T25["parent"]:this;var _8xC=document.createElement("DIV");try{_8xC.expanded=false;_8xC.selected=false;_8xC.rendered=false;_8xC.nodes=[];_8xC.DA_TYPE="NODE";_8xC.id=domapi.guid();_8xC.JR_g3=p;if(p!=this)p.lineHeight=this.lineHeight;_8xC.innerHTML=domapi.mJ00.tree._66G8(_8xC,p);_8xC.doAllowSelect=domapi.rBool(i2T25["doAllowSelect"],true);_8xC.doAllowNodeDrag=domapi.rBool(i2T25["doAllowNodeDrag"],true);_8xC.doAllowNodeDrop=domapi.rBool(i2T25["doAllowNodeDrop"],true);this.setText(_8xC,domapi.rVal(i2T25["text"],"New Node"));for(var a in i2T25)if(typeof _8xC[a]=="undefined"&&a!="nodes")_8xC[a]=i2T25[a];if(typeof i2T25["order"]!="undefined"&&i2T25["order"]!=null){var wc$17=i2T25["order"];if(wc$17>=p.nodes.length){p.nodes.push(_8xC)}else{var x25WN=p.nodes.slice(0,p.nodes.length);for(i=0,k$Vu=0;i<x25WN.length;i++,k$Vu++){if(i==wc$17){p.nodes[k$Vu]=_8xC;k$Vu++}p.nodes[k$Vu]=x25WN[i]}}}else{p.nodes.push(_8xC)}return _8xC}finally{p=null;_8xC=null;x25WN=null}};domapi.comps.tree.insertNode=function(i2T25){var __4=i2T25["fromNode" ];var t=i2T25["toNode" ];try{if(!t)t=this;var p=i2T25["sourceTree"];if(i2T25["insertAbove"]||i2T25["insertBelow"]){t=t.parentNode;var i=t.nodes.indexOf(i2T25["toNode"])}if(!__4||!t||!p){throw new Error('Error in insertNode, one or more parameters is invalid./n'+'fromNode   : '+__4+'/n'+'toNode     : '+t+'/n'+'sourceTree : '+p);return false}p.getParentNode(__4).nodes.deleteValue(__4);var _8xC=p.deleteNode(__4);_8xC.JR_g3=t;var d1_K=t.nodes.length;if(i2T25["insertAbove"]){t.nodes.insert(i,_8xC)}else if(i2T25["insertBelow"]){t.nodes.insert(i+1,_8xC)}else t.nodes.push(_8xC);if(d1_K>=t.nodes.length)throw new Error('Error in insertNode, failed to insert into nodes array./n'+'fromNode     : '+__4+'/n'+'toNode       : '+t+'/n'+'sourceTree   : '+p+'/n'+'i            : '+i+'/n'+'checksum     : '+d1_K+'/n'+'nodes.length : '+t.nodes.length);_8xC.rendered=false;_8xC.selected=false;this.expandNode(t);this.renderNode(_8xC,t,true);p.refresh(null,true);this.refresh(null,true)}finally{__4=null;t=null;p=null;_8xC=null}};domapi.comps.tree.deleteNode=function(_8xC){if(!_8xC)return this.b_6("deleteNode");var p=this.getParentNode(_8xC);try{p.nodes.deleteItem(p.nodes.indexOf(_8xC));var x3A00=_8xC.parentNode.removeChild(_8xC);if(p.nodes.length==0)p.expanded=false;if(this.selected===_8xC)this.selected=null;return x3A00}finally{p=null;x3A00=null}};domapi.comps.tree.clear=function(_8xC){var i;var C=this.childNodes;try{this.deselectNode();for(i=C.length-1;i>-1;i--)this.removeChild(C[i]);this.innerHTML="";this.nodes=[]}finally{C=null}};domapi.comps.tree.addPath=function(i2T25){var _93Dq=i2T25["path"];var del=domapi.rVal(i2T25["del"],this.delimiter);var p=i2T25["parent"]?i2T25["parent"]:this;try{_93Dq=_93Dq.split(del);var a,b,FnP34,s,KlI1$;var _8xC=p;for(a=0;a<_93Dq.length;a++){FnP34=0;s=0;for(b=0;b<_8xC.nodes.length;b++){s=_8xC.nodes[b];if(this.getText(s)==_93Dq[a]){_8xC=s;FnP34=1;break}}if(!FnP34){KlI1$=a==(_93Dq.length-1);_8xC=this.addNode({parent:_8xC,text:_93Dq[a],m2rC:KlI1$?i2T25.m2rC:null,img:KlI1$?i2T25.img:null})}}return _8xC}finally{p=null;_8xC=null}};domapi.comps.tree.getPath=function(_8xC,del){if(!_8xC)return this.b_6("getPath");del=domapi.rVal(del,this.delimiter);var r="";while(_8xC&&_8xC!=this){if(r!="")r=del+r;r=this.getText(_8xC).replace(del,"\\"+del)+r;if(_8xC.JR_g3)_8xC=_8xC.JR_g3;else _8xC=_8xC.parentNode}return r};domapi.comps.tree.pathExists=function(_93Dq,del){return this.T5qep(_93Dq,del,false,false)};domapi.comps.tree.nodeFromPath=function(_93Dq,del){del=domapi.rVal(del,this.delimiter);_93Dq=_93Dq.split(del);var a,b,FnP34,s;var _8xC=this;try{for(a=0;a<_93Dq.length;a++){FnP34=0;s=0;for(b=0;b<_8xC.nodes.length;b++){s=_8xC.nodes[b];if(this.getText(s)==_93Dq[a]){_8xC=s;FnP34=1;break}}if(!FnP34)return null}return _8xC}finally{_8xC=null}};domapi.comps.tree.init=function(_8xC,m5Mo){if(!_8xC)_8xC=this;for(var i=0;i<_8xC.nodes.length;i++)this.renderNode(_8xC.nodes[i],_8xC,m5Mo)};domapi.comps.tree.nodeLevel=function(_8xC,p){if(!_8xC)return this.b_6("nodeLevel");var r=0;var x3A00=_8xC.parentNode;try{if(!x3A00)x3A00=p;while(x3A00!=this){r++;if(x3A00)x3A00=x3A00.parentNode;else x3A00=this}return r}finally{x3A00=null}};domapi.comps.tree.nodeIsChild=function(_8xC){if(!_8xC)return this.b_6("nodeIsChild");return this.nodeIsChildOfNode(_8xC,this)==this};domapi.comps.tree.nodeIsChildOfNode=function(_8xC,p){return _8xC&&p&&domapi.findParent(_8xC,p)==p};domapi.comps.tree.childCount=function(_8xC){if(!_8xC)return this.b_6("childCount");return _8xC.nodes.length};domapi.comps.tree.hasChildren=function(_8xC){if(!_8xC)return this.b_6("hasChildren");return _8xC.hasChildren?true:(this.childCount(_8xC)>0)};domapi.comps.tree.getParentNode=function(_8xC){if(!_8xC)return this.b_6("getParentNode");return _8xC.JR_g3?_8xC.JR_g3:_8xC.parentNode};domapi.comps.tree.getPreviousSibling=function(_8xC){if(!_8xC)return this.b_6("getPreviousSibling");var p=this.getParentNode(_8xC).nodes;try{var i=p.indexOf(_8xC);if(i==-1)return this.b_6("getPreviousSibling - not in nodes");return i>0?p[i-1]:null}finally{p=null}};domapi.comps.tree.getNextSibling=function(_8xC){if(!_8xC)return this.b_6("getNextSibling");var p=this.getParentNode(_8xC);try{if(!p||typeof p.nodes=="undefined")return null;var Cj199=p.nodes;var i=Cj199.indexOf(_8xC);if(i==-1)return this.b_6("getNextSibling - not in nodes");return(i<(Cj199.length-1))?Cj199[i+1]:null}finally{p=null;Cj199=null}};domapi.comps.tree.getLastExpandedChild=function(_8xC){if(!_8xC)return this.b_6("getLastExpandedChild");if(this.hasChildren(_8xC.nodes[_8xC.nodes.length-1])&&_8xC.nodes[_8xC.nodes.length-1].expanded)return this.getLastExpandedChild(_8xC.nodes[_8xC.nodes.length-1]);else return _8xC.nodes[_8xC.nodes.length-1]};domapi.comps.tree.getTextCell=function(_8xC){if(!_8xC)return this.b_6("getTextCell");return _8xC.childNodes[0].rows[0].cells[1]};domapi.comps.tree.setText=function(_8xC,t){if(!_8xC)return this.b_6("setText");this.getTextCell(_8xC).innerHTML=t};domapi.comps.tree.getText=function(_8xC){if(!_8xC)return this.b_6("getText");return this.getTextCell(_8xC).innerHTML};domapi.comps.tree.expandNode=function(_8xC){if(!_8xC)return this.b_6("expandNode");if(_8xC.expanded)return;if(this.getParentNode(_8xC)&&!this.getParentNode(_8xC).rendered)this.expandPath(this.getPath(_8xC));_8xC.expanded=true;this.init(_8xC);for(var i=0;i<_8xC.nodes.length;i++)_8xC.nodes[i].style.display="";this.setImages(_8xC);if(this.onexpandnode)this.onexpandnode(_8xC)};domapi.comps.tree.expandPath=function(_93Dq,del,l3B){return this.T5qep(_93Dq,del,true,l3B)};domapi.comps.tree.collapseNode=function(_8xC){if(!_8xC)return this.b_6("collapseNode");_8xC.expanded=false;this.setImages(_8xC);for(var i=0;i<_8xC.nodes.length;i++)_8xC.nodes[i].style.display="none";if(this.oncollapsenode)this.oncollapsenode(_8xC)};domapi.comps.tree.expandAll=function(_8xC){var kLb=function(i64R,_8xC){var FSM$,i;try{for(i=0;i<_8xC.nodes.length;i++){FSM$=_8xC.nodes[i];if(FSM$.DA_TYPE=="NODE")i64R.expandNode(FSM$);kLb(i64R,FSM$)}}finally{FSM$=null}};_8xC=_8xC?_8xC:this;kLb(this,_8xC);kLb=null};domapi.comps.tree.collapseAll=function(_8xC){var kLb=function(i64R,_8xC){var FSM$,i;try{for(i=0;i<_8xC.nodes.length;i++){FSM$=_8xC.nodes[i];if(FSM$.DA_TYPE=="NODE")i64R.collapseNode(FSM$);kLb(i64R,FSM$)}}finally{FSM$=null}};_8xC=_8xC?_8xC:this;kLb(this,_8xC);kLb=null};domapi.comps.tree.paintNode=function(_8xC,kind){if(!_8xC)return this.b_6("paintNode");kind=domapi.rInt(kind,tptWindow);var c=_8xC.childNodes[0].rows[0].cells[1];var __4=domapi.theme.fonts;switch(kind){case tptWindow:__4="DA_WINDOW";break;case tptHighlight:__4="DA_HIGHLIGHT";break;case tptSelection:__4="DA_SELECTION";break}if(this.doSelectRow){_8xC.Kn3L=__4;domapi.mJ00.tree.u729d(_8xC)}c.Kn3L=__4;domapi.mJ00.tree.u729d(c);if(this.ondrawnode)this.ondrawnode(_8xC);__4=null};domapi.comps.tree.deselectNode=function(){if(this.selected){this.selected.selected=false;domapi.comps.tree.paintNode(this.selected,tptWindow);this.selected=null}};domapi.comps.tree.selectNode=function(_8xC,f3msv){if(!_8xC)return this.b_6("selectNode");if(_8xC.selected||this.selected==_8xC)return;if(this.selected){this.selected.selected=false;this.setImages(this.selected);var __4=domapi.theme.fonts.window;this.paintNode(this.selected,tptWindow)}_8xC.selected=true;this.selected=_8xC;this.paintNode(_8xC,tptSelection);this.setImages(_8xC);this.setValue(this.getPath(this.selected));if(!f3msv){if(_8xC.m2rC){if(typeof _8xC.m2rC=="function")_8xC.m2rC(_8xC);else eval(_8xC.m2rC)}}};domapi.comps.tree.setImages=function(_8xC){if(!_8xC)return this.b_6("setImages");var s=domapi.theme.skin;try{if(this.doShowLines)var src=["tree_lines"];else var src=["tree_noline"];if(!_8xC.childNodes[0]||!_8xC.childNodes[0].rows)return;var c=_8xC.childNodes[0].rows[0].cells[0];var a=c.getElementsByTagName("IMG");if(!a.length)return;if(this.getNextSibling(_8xC)){src[1]="_t"}else{src[1]="_l"}if(this.getParentNode(_8xC).DA_TYPE=="TREE"&&!this.getPreviousSibling(_8xC))src[1]=(this.getNextSibling(_8xC)||((src[0]=="tree_noline")&&(!this.hasChildren(_8xC))))?src[1]="_b":src[1]="_r";var K913=a[a.length-1];var FY6D5=a[a.length-2];K913.kind="leaf";FY6D5.kind="node";if(this.hasChildren(_8xC))src[2]=_8xC.expanded?"_opened":"_closed";if(_8xC.img)K913.src=_8xC.img;else K913.src=(_8xC.expanded||_8xC.selected)?s["tree_folder_opened"]:s["tree_folder_closed"];FY6D5.src=s[src.join("")];if(this.doShowLines&&a.length>2){for(var i=a.length-3;i>-1;i--){_8xC=this.getParentNode(_8xC);if(this.getNextSibling(_8xC))a[i].src=s["tree_lines_i"]}}if(this.onsetimages)this.onsetimages(_8xC)}finally{s=null;c=null;a=null;K913=null;FY6D5=null}};domapi.comps.tree.createImages=function(_8xC,p){if(!_8xC)return this.b_6("createImages");var s=domapi.theme.skin;try{var c=_8xC.childNodes[0].rows[0].cells[0];c.innerHTML="";var img;for(var i=0;i<_8xC.level+2;i++){img=document.createElement("IMG");img.src=s["tree_blank"];if(i==_8xC.level+1){img.width=p.P1266?(_8xC.P1266=p.P1266):(_8xC.P1266?_8xC.P1266:16);img.height=p.SH34?(_8xC.SH34=p.SH34):(_8xC.SH34?_8xC.SH34:16);img.alt=_8xC.nk0y6?_8xC.nk0y6:_8xC.text}else img.align=domapi.isIE?"absmiddle":"top";img.kind="blank";c.appendChild(img)}c.I7_="DA_TREE_IMAGES";c.Kn3L="";domapi.mJ00.tree.u729d(c)}finally{s=null;img=null;c=null}};domapi.comps.tree.renderNode=function(_8xC,p,m5Mo){if(!_8xC)return this.b_6("renderNode");p=p?p:this;if(_8xC.rendered&&!m5Mo)return;var i,k$Vu;for(i=0,k$Vu=1;i<p.nodes.length;i++){if(p.nodes[i]===_8xC)break;if(p.nodes[i].rendered)k$Vu++}if(p.expanded==false)_8xC.style.display="none";if(k$Vu>=p.childNodes.length){p.appendChild(_8xC)}else p.insertBefore(_8xC,p.childNodes[k$Vu]);domapi.comps.tree.paintNode(_8xC,tptWindow);_8xC.level=this.nodeLevel(_8xC,p);this.createImages(_8xC,p);this.setImages(_8xC);_8xC.rendered=true;if(domapi.isGecko)delete _8xC.JR_g3;else _8xC.JR_g3=null;_8xC.I7_=_8xC.nextSibling?"DA_TREE_NODE":"DA_TREE_NODE_LASTCHILD";_8xC.Kn3L="";domapi.mJ00.tree.u729d(_8xC);if(this.onrendernode)this.onrendernode(_8xC,p)};domapi.comps.tree.b_6=function(xk1){throw new Error("ERROR!\n"+domapi.formatGetString("TREE_NO_NODE",[xk1]));return false};domapi.comps.tree.T5qep=function(_93Dq,del,j2EoV,l3B){del=domapi.rVal(del,this.delimiter);_93Dq=_93Dq.split(del);var a,b,FnP34,s;var _8xC=this;try{for(a=0;a<_93Dq.length;a++){FnP34=0;s=0;for(b=0;b<_8xC.nodes.length;b++){s=_8xC.nodes[b];if(this.getText(s)==_93Dq[a]){_8xC=s;FnP34=1;break}}if(!FnP34)return false;if(j2EoV)this.expandNode(_8xC);if(l3B)this.selectNode(_8xC)}return true}finally{_8xC=null;s=null}};domapi.comps.tree.loadFromJson=function(k$Vu,Q0038){domapi.assertUnit("json");this.$tX(k$Vu,Q0038);this.init(Q0038?Q0038:this,true);this.draw();if(this.selected)this.paintNode(this.selected,tptSelection);if(this.onloadfromjson)this.onloadfromjson(Q0038?Q0038:this)};domapi.comps.tree.$tX=function(k$Vu,Q0038){domapi.assertUnit("json");try{var nodes=k$Vu.nodes;try{if(!nodes)return false;if(!Q0038)Q0038=this;var b95NX;for(var i=0;i<nodes.length;i++){nodes[i].parent=Q0038;b95NX=this.addNode(nodes[i]);this.$tX(nodes[i],b95NX)}}finally{nodes=null;b95NX=null}}catch(x3A00){}};domapi.comps.tree.loadFromJsonUrl=function(url,Ea79){domapi.assertUnit("json");var k$Vu=domapi.urlToJson(url);try{this.loadFromJson(k$Vu,Ea79)}finally{k$Vu=null}};domapi.comps.tree.saveToJson=function(i64R){return domapi.stringToJson(this.saveToJsonString(i64R,false))};domapi.comps.tree.saveToJsonString=function(i64R,j37X){var _8xC,i,s="";var t=(i64R)?i64R:this;var ocK="";var hl97y=(j37X)?false:true;if(hl97y)s+="{";if(t.nodes.length){s+="nodes : [";for(i=0;i<t.nodes.length;i++){_8xC=t.nodes[i];if(_8xC){t716w=this.saveToJsonString(_8xC,true);if(t716w.length!=0)t716w=", "+t716w;s+=ocK+"{ text : \""+this.getText(_8xC)+"\", value : \""+_8xC.value+"\", expanded : "+_8xC.expanded+t716w+" }";if(ocK.length==0)ocK=","}}s+="]"}if(hl97y)s+="}";return s};domapi.comps.tree.saveToXML=function(i64R,Pv9uJ){var _8xC,i,s="";var t=(i64R)?i64R:this;Pv9uJ=Pv9uJ?"\n":"";for(i=0;i<t.nodes.length;i++){_8xC=t.nodes[i];if(_8xC)s+="<item text=\""+this.getText(_8xC)+"\">"+Pv9uJ+this.saveToXML(_8xC,Pv9uJ)+"</item>"+Pv9uJ;}return s};domapi.comps.tree.ondragallow=function(i2T25){var x3A00=domapi.findParent(domapi.customDrag.elm,"NODE");var p=domapi.customDrag.container;try{return x3A00&&p!=x3A00&&p.doAllowDrag&&x3A00.doAllowNodeDrag}finally{x3A00=null;p=null}};domapi.comps.tree.ondragstart=function(i2T25){var p8Td=domapi.customDrag;p8Td.elm=domapi.findParent(p8Td.elm,"NODE");if(!p8Td.elm)p8Td.container.cancelCustomDrag();p8Td=null};domapi.comps.tree.onallowinsertabove=function(i2T25){var x3A00=domapi.findParent(i2T25["over"],"NODE");try{return(x3A00)}finally{x3A00=null}};domapi.comps.tree.onallowinsertbelow=function(i2T25){var x3A00=domapi.findParent(i2T25["over"],"NODE");try{return(x3A00)}finally{x3A00=null}};domapi.mJ00.tree.T3S=function(E){domapi.mJ00.tree.Ux4(E,tptHighlight)};domapi.mJ00.tree.C06=function(E){domapi.mJ00.tree.Ux4(E,tptWindow)};domapi.mJ00.tree.Ux4=function(E,kind){var x3A00=domapi.findTarget(E,"TD");try{if(!x3A00||x3A00.I7_!="DA_TREE_TEXT")return;var p=domapi.findTarget(E,"TREE");var _8xC=domapi.findParent(x3A00,"NODE");if(!p.doRollover||!p.enabled||_8xC.selected||(domapi.customDrag.inDrag&&kind!=tptWindow))return;p.paintNode(_8xC,kind)}finally{x3A00=null;p=null;_8xC=null}};domapi.mJ00.tree.qALD0=function(E){var p=domapi.findTarget(E,"TREE");try{if(!p||!p.enabled||domapi.customDrag.inDrag)return;var x3A00=domapi.findTarget(E,"TD");var _8xC=domapi.findParent(x3A00,"NODE");if(x3A00&&x3A00.I7_=="DA_TREE_TEXT")if(p.doDblClickTextExpands)if(_8xC.expanded)p.collapseNode(_8xC);else p.expandNode(_8xC);var x3A00=domapi.findTarget(E,"IMG");if(x3A00&&x3A00.kind&&x3A00.kind!="blank"){if(x3A00.kind=="leaf")if(p.doDblClickFolderExpands&&p.hasChildren(_8xC))if(_8xC.expanded)p.collapseNode(_8xC);else p.expandNode(_8xC)}}finally{p=null;x3A00=null;_8xC=null}};domapi.mJ00.tree.e2xtH=function(E){var p=domapi.findTarget(E,"TREE");try{if(!p||!p.enabled||domapi.customDrag.inDrag)return;var x3A00=domapi.findTarget(E,"TD");var _8xC=domapi.findParent(x3A00,"NODE");if(x3A00&&x3A00.I7_=="DA_TREE_TEXT"){if(_8xC.doAllowSelect)p.selectNode(_8xC);if(p.doTextExpands)if(_8xC.expanded)p.collapseNode(_8xC);else p.expandNode(_8xC)}var x3A00=domapi.findTarget(E,"IMG");if(x3A00&&x3A00.kind&&x3A00.kind!="blank"){if(x3A00.kind=="node"){if(!p.hasChildren(_8xC))return;if(_8xC.expanded)p.collapseNode(_8xC);else p.expandNode(_8xC)}if(x3A00.kind=="leaf"){if(p.doFolderExpands&&p.hasChildren(_8xC))if(_8xC.expanded)p.collapseNode(_8xC);else p.expandNode(_8xC);if(p.doFolderSelects&&_8xC.doAllowSelect)p.selectNode(_8xC)}}}finally{p=null;x3A00=null;_8xC=null}};domapi.mJ00.tree.i$144=function(E){var bM2=domapi.isIE?event.keyCode:E.which;var x3A00=domapi.getTarget(E);var r=x3A00.o55Q;try{if(!r)r=domapi.findTarget(E,"TREE");var i$4_=false;var i,Fyr,_8xC;var shiftKey=domapi.isIE?event.shiftKey:E.shiftKey;var ctrlKey=domapi.isIE?event.ctrlKey:E.ctrlKey;if(!r._832W){if(bM2==33)r.scrollTop-=r.offsetHeight;if(bM2==34)r.scrollTop+=r.offsetHeight;if(bM2==35&&ctrlKey){Fyr=r.getElementsByTagName("DIV");for(i=Fyr.length-1;i>-1;i--)if(Fyr[i].DA_TYPE=="NODE"&&Fyr[i].doAllowSelect){r.selectNode(Fyr[i]);break}}if(bM2==36&&ctrlKey){Fyr=r.getElementsByTagName("DIV");for(i=0;i<Fyr.length;i++)if(Fyr[i].DA_TYPE=="NODE"&&Fyr[i].doAllowSelect){r.selectNode(Fyr[i]);break}}if(bM2==38){if(r.selected)domapi.mJ00.tree.u2L70(r);i$4_=true}if(bM2==40){if(r.selected)domapi.mJ00.tree.T5a(r);i$4_=true}if(bM2==37){if(r.selected)domapi.mJ00.tree.iT7x(r);i$4_=true}if(bM2==39){if(r.selected)domapi.mJ00.tree.e8$8(r);i$4_=true}}if(i$4_){if(E&&E.preventDefault)E.preventDefault();return false}}finally{x3A00=null;r=null;Fyr=null;_8xC=null}};domapi.mJ00.tree.u2L70=function(r){var _8xC=r.getPreviousSibling(r.selected);try{if(_8xC){if(_8xC.expanded&&r.hasChildren(_8xC))_8xC=r.getLastExpandedChild(_8xC)}else _8xC=r.getParentNode(r.selected);if(_8xC&&_8xC.doAllowSelect)r.selectNode(_8xC);domapi.mJ00.tree.UKB93(r)}finally{_8xC=null}};domapi.mJ00.tree.T5a=function(r){var _8xC;try{if(r.hasChildren(r.selected)&&r.selected.expanded)_8xC=r.selected.nodes[0];else{_8xC=r.getNextSibling(r.selected);if(!_8xC){_8xC=r.selected;while(_8xC){_8xC=r.getParentNode(_8xC);if(_8xC&&r.getNextSibling(_8xC)){_8xC=r.getNextSibling(_8xC);break}}}}if(_8xC&&_8xC.doAllowSelect)r.selectNode(_8xC);domapi.mJ00.tree.UKB93(r)}finally{_8xC=null}};domapi.mJ00.tree.iT7x=function(r){if(r.selected.expanded)r.collapseNode(r.selected);else try{var _8xC=r.getParentNode(r.selected);if(_8xC&&_8xC.doAllowSelect)r.selectNode(_8xC)}finally{_8xC=null}};domapi.mJ00.tree.e8$8=function(r){if(!r.selected.expanded)r.expandNode(r.selected);else try{if(r.hasChildren(r.selected)){var _8xC=r.selected.nodes[0];if(_8xC&&_8xC.doAllowSelect)r.selectNode(_8xC)}}finally{_8xC=null}};domapi.mJ00.tree.u729d=function(x3A00){if(typeof x3A00.I7_=="undefined")x3A00.I7_=x3A00.className.split(" ")[0];if(typeof x3A00.Kn3L=="undefined")x3A00.Kn3L="";if(x3A00.I7_&&x3A00.Kn3L)x3A00.className=sysutils.trim(x3A00.I7_+" "+x3A00.Kn3L)};domapi.mJ00.tree.UKB93=function(r){var Y4_x=r.selected.offsetTop;var y;if(Y4_x<r.scrollTop){y=Y4_x-5;r.scrollTop=(y>0?y:0)}else if(Y4_x>r.scrollTop+r.offsetHeight-13){y=Y4_x-r.offsetHeight+25;r.scrollTop=y}};domapi.mJ00.tree._66G8=function(_8xC,p){var lineHeight=p.lineHeight?p.lineHeight:_8xC.lineHeight?_8xC.lineHeight:16;return '<table style="display:block" class="DA_TREE_NODE" cellpadding="0" cellspacing="0" border="0"><tr>'+'<td height='+lineHeight+' class="DA_TREE_IMAGES" nowrap></td><td width="100%" class="DA_TREE_TEXT DA_TREE_NORMAL"></td></tr></table>'};