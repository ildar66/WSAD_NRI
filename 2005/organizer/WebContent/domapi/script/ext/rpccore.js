/*
Copyright (c) Nebiru Software 2001, 2005
  Compressed and obfuscated by JSCruncher Pro.
  http://domapi.com/jscruncherpro
*/
domapi.loadUnit("rpcpacket");domapi.rpc={};domapi.rpc.charset="ISO-8859-1";domapi.rpc.doDebug=false;domapi.rpc.manageCursor=true;domapi.rpc.timeout=30000;domapi.rpc.lastError="";domapi.rpc.lastUrl="";domapi.rpc.H53=[];domapi.rpc.ToS5=[];domapi.rpc.$835d=[];domapi.rpc.Lr6="default";domapi.rpc.j8L="domapi_rpc_dispatch";domapi.E468=null;domapi.rpc.onsend=function(packet){};domapi.rpc.onreceive=function(packet){};domapi.rpc.ontimeout=function(packet){};domapi.rpc.setCursor=function(R63){var s=domapi.bodyElm().style;var t=this;if(R63)t.Lr6=s.cursor;if(t.manageCursor)s.cursor=R63?"wait":t.Lr6};domapi.rpc.sendPacket=function(i2T25){try{var p=i2T25["packet" ];var wT9=i2T25["onreceive"];var timeout=i2T25["timeout" ];var RR4_=i2T25["ontimeout"];if(this.doDebug)alert("Sending packet "+p.guid);if(wT9)this.H53.push([p.guid,wT9]);if(RR4_)this.ToS5.push([p.guid,RR4_]);this.setCursor(1);if(p.method==mtGet)return this.m794(p,timeout);if(p.method==mtPost)return this.w3$c(p,timeout);return-2}catch(E){if(this.doDebug)alert("Error in sendPacket:"+E.message);this.lastError=E.message;return-1}};domapi.rpc.receivePacket=function(packet){try{if(this.doDebug)alert("Receiving packet "+packet.guid);if(this.uY54k!=null){if(domapi.isIE5)this.uY54k.location.replace('about:blank');else if(domapi.isIE)this.uY54k.contentWindow.location.replace('about:blank')}var method;var FnP34=false;for(var a=0;a<this.$835d.length;a++)if(this.$835d[a].guid==packet.guid){method=this.$835d[a].method;this.$835d.deleteItem(a);FnP34=true}if(!FnP34){this.lastError=domapi.getString("RPC_TIMED_OUT");if(this.doDebug)alert(this.lastError);if(this.$835d.length==0)this.setCursor(0);return-2}this.onreceive(packet);if(this.doDebug)alert("_handlers="+this.H53);for(a=0;a<this.H53.length;a++)if(this.H53[a][0]==packet.guid){if(this.doDebug)alert("Handler found for packet "+packet.guid);var L6M9=this.H53[a][1];if(L6M9&&L6M9!="undefined"){var obj=null;var m2rC=L6M9;var P0D0=[packet];if(typeof(L6M9)=="object"){obj=L6M9.obj;m2rC=L6M9.m2rC;P0D0=P0D0.concat(L6M9.P0D0);if(this.doDebug)if(obj)alert("OO with object, obj: "+obj+"\nfn:\n"+m2rC+"\nparams: "+P0D0.toString());else alert("OO with null-object, obj: "+obj+"\nfn:\n"+m2rC+"\nparams: "+P0D0.toString())}else if(this.doDebug)alert("Non-OO, obj: "+obj+"\nfn:\n"+m2rC+"\nparams: "+P0D0.toString());m2rC.apply(obj,P0D0)}this.H53.deleteItem(a);break}status=defaultStatus;if(method==mtGet){var t=document.getElementById(packet.guid);if(t){if(this.E468)this.E468.removeChild(t);else throw({message:domapi.getString("RPC_NO_HEAD1")})}else throw({message:domapi.getString("RPC_NO_SCRIPT")})}if(this.$835d.length==0)this.setCursor(0);return 1}catch(E){if(this.doDebug)alert("Error in receivePacket:"+E.message);this.lastError=E.message;return-1}};domapi.rpc.m794=function(p,timeout){try{if(!p)return-2;var p8Td=p.data;var url=p.url;url+=((p.url.indexOf("?")!=-1)?"&":"?")+"guid="+p.guid+"&ds="+new Date().getTime()+"&method=GET"+"&"+p8Td.saveToURL("&","=",true);if(this.doDebug){alert("Dispatching: "+url);window.open(url,null,"status=yes,toolbar=yes,",null)}var e28x=document.createElement("SCRIPT");e28x.charset=this.charset;e28x.src=url;e28x.type="text/javascript";e28x.defer=true;e28x.id=p.guid;this.lastUrl=url;if(!this.E468)this.E468=this.P30U();if(!this.E468)throw({message:domapi.getString("RPC_NO_HEAD2")});status=p.statusText;this.$835d.push(p);this.E468.appendChild(e28x);setTimeout("domapi.rpc.E_1('"+p.guid+"')",timeout==null?this.timeout:timeout*1000);this.onsend(p);return 1}catch(E){if(this.doDebug)alert("Error in _dispatchAsGet:"+E.message);this.lastError=E.message;return-1}};domapi.rpc.w3$c=function(p,timeout){try{if(!p)return-2;this.iy3();if(domapi.isIE5)var eVD7=this.uY54k.document;else var eVD7=domapi.isIE?this.uY54k.contentWindow.document:this.uY54k.contentDocument;var p8Td=p.data;var url=p.url+=((p.url.indexOf("?")!=-1)?"&":"?")+"guid="+p.guid+"&ds="+new Date().getTime()+"&method=POST";if(this.doDebug){alert("Dispatching: "+url);window.open(url,"debugwin","status=yes,toolbar=yes,",null)}var SWMm3='<html><body>'+'<form name="rpcForm" method="post" target="" action="'+url+'">';for(var a=0;a<p8Td.names.length;a++)SWMm3+='<input type="hidden" name="'+p8Td.names[a]+'" value="'+encodeURI(p8Td.values[a])+'">';SWMm3+='</form></body></html>';eVD7.open();eVD7.write(SWMm3);eVD7.close();status=p.statusText;this.$835d.push(p);eVD7.forms['rpcForm'].submit();if(this.doDebug){eVD7.forms['rpcForm'].target="debugwin";eVD7.forms['rpcForm'].submit()}setTimeout("domapi.rpc.E_1('"+p.guid+"')",timeout==null?this.timeout:timeout*1000);this.onsend(p);return 1}catch(E){if(this.doDebug)alert("Error in _dispatchAsPost:"+E.message);this.lastError=E.message;return-1}};domapi.rpc.P30U=function(){var h=document.getElementsByTagName("HEAD");return(h.length>0)?h[0]:null};domapi.rpc.E_1=function(guid){var $yNKC=false;for(var a=0;a<this.$835d.length;a++)if(this.$835d[a].guid==guid){for(var b=0;b<this.ToS5.length;b++)if(this.ToS5[b][0]==guid){$yNKC=true;this.$835d.deleteItem(a);var I6i=this.ToS5[b][1];if(I6i&&I6i!="undefined"){var obj=null;var m2rC=I6i;var P0D0=[];if(typeof(I6i)=="object"){obj=I6i.obj;m2rC=I6i.m2rC;P0D0=P0D0.concat(I6i.P0D0);if(this.doDebug)if(obj)alert("OO with object, obj: "+obj+"\nfn:\n"+m2rC+"\nparams: "+P0D0.toString());else alert("OO with null-object, obj: "+obj+"\nfn:\n"+m2rC+"\nparams: "+P0D0.toString())}else if(this.doDebug)alert("Non-OO, obj: "+obj+"\nfn:\n"+m2rC+"\nparams: "+P0D0.toString());m2rC.apply(obj,P0D0)}this.ToS5.deleteItem(b);break}if(!$yNKC){this.ontimeout(this.$835d[a]);this.$835d.deleteItem(a)}}};domapi.rpc.iy3=function(){if(this.uY54k)if(domapi.isIE&&!domapi.isIE5&&typeof(this.uY54k.contentWindow.document.namespaces)!="object")document.body.removeChild(this.uY54k);else return;this.uY54k=domapi.createIFrame(this.j8L);document.body.appendChild(this.uY54k);if(!this.debugMode)this.uY54k.style.display="none";if(domapi.isIE5)this.uY54k=window.frames[this.j8L]};